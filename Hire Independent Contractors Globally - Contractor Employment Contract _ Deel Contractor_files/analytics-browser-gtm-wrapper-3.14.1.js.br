(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),((e,t,n)=>{!function(e,t){var n=e.amplitudeGTM||{_q:[],_iq:{}};if(n.invoked)e.console&&console.error&&console.error("Amplitude snippet has been loaded.");else{var r=function(e,t){e.prototype[t]=function(){return this._q.push({name:t,args:Array.prototype.slice.call(arguments,0)}),this}},i=function(e,t,n){return function(r){e._q.push({name:t,args:Array.prototype.slice.call(n,0),resolve:r})}},o=function(e,t,n){e._q.push({name:t,args:Array.prototype.slice.call(n,0)})},s=function(e,t,n){e[t]=function(){if(n)return{promise:new Promise(i(e,t,Array.prototype.slice.call(arguments)))};o(e,t,Array.prototype.slice.call(arguments))}},a=function(e){for(var t=0;t<m.length;t++)s(e,m[t],!1);for(var n=0;n<g.length;n++)s(e,g[n],!0)};n.invoked=!0;var c=t.createElement("script");c.type="text/javascript",c.integrity="sha384-0QKRyflfD7HralXNtrlEj+djFxUCAlXdIRQwss7f2ldUa/xkc6Ra0akH4jxA0SXw",c.crossOrigin="anonymous",c.async=!0,c.src="https://cdn.amplitude.com/libs/analytics-browser-gtm-2.12.2-min.js.gz",c.onload=function(){e.amplitudeGTM.runQueuedFunctions||console.log("[Amplitude] Error: could not load SDK")};var l=t.getElementsByTagName("script")[0];l.parentNode.insertBefore(c,l);for(var u=function(){return this._q=[],this},d=["add","append","clearAll","prepend","set","setOnce","unset","preInsert","postInsert","remove","getUserProperties"],p=0;p<d.length;p++)r(u,d[p]);n.Identify=u;for(var h=function(){return this._q=[],this},f=["getEventProperties","setProductId","setQuantity","setPrice","setRevenue","setRevenueType","setReceipt","setReceiptSig","setCurrency","setEventProperties"],v=0;v<f.length;v++)r(h,f[v]);n.Revenue=h;var m=["getDeviceId","setDeviceId","getSessionId","setSessionId","getUserId","setUserId","setOptOut","setTransport","reset","extendSession"],g=["init","add","remove","track","logEvent","identify","groupIdentify","setGroup","revenue","flush"];a(n),n.createInstance=function(e){return n._iq[e]={_q:[]},a(n._iq[e]),n._iq[e]},e.amplitudeGTM=n,e.amplitude||(e.amplitude=e.amplitudeGTM)}}(window,document);var r=function(e){var t=function(){return t=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},t.apply(this,arguments)};function n(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}function r(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}var i=function(){var e=this;return{name:"@amplitude/plugin-page-view-v1-enrichment-browser",type:"enrichment",setup:function(e){return n(this,void 0,void 0,(function(){return r(this,(function(t){return e.loggerProvider.log("Installing @amplitude/plugin-page-view-v1-enrichment-browser."),[2]}))}))},execute:function(i){return n(e,void 0,void 0,(function(){var e,n,o,s,a,c;return r(this,(function(r){return"[Amplitude] Page Viewed"==i.event_type&&(e=i.event_properties||{},n=e["[Amplitude] Page Domain"],o=e["[Amplitude] Page Location"],s=e["[Amplitude] Page Path"],a=e["[Amplitude] Page Title"],c=e["[Amplitude] Page URL"],(i=t(t({},i),{event_type:"Page View",event_properties:t(t({},i.event_properties),{page_domain:null!=n?n:"",page_location:null!=o?o:"",page_path:null!=s?s:"",page_title:null!=a?a:"",page_url:null!=c?c:""})})).event_properties&&(delete i.event_properties["[Amplitude] Page Domain"],delete i.event_properties["[Amplitude] Page Location"],delete i.event_properties["[Amplitude] Page Path"],delete i.event_properties["[Amplitude] Page Title"],delete i.event_properties["[Amplitude] Page URL"])),[2,i]}))}))}}};return e.pageViewV1EnrichmentPlugin=i,e.plugin=i,Object.defineProperty(e,"__esModule",{value:!0}),e}({}),i=function(e){var t=function(){return t=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},t.apply(this,arguments)};function r(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}function i(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},s={exports:{}};!function(e,t){!function(n,r){var i="function",o="undefined",s="object",a="string",c="model",l="name",u="type",d="vendor",p="version",h="architecture",f="console",v="mobile",m="tablet",g="smarttv",y="wearable",b="embedded",w="Amazon",S="Apple",I="ASUS",k="BlackBerry",C="Browser",M="Chrome",x="Firefox",E="Google",O="Huawei",T="LG",R="Microsoft",_="Motorola",D="Opera",N="Samsung",L="Sharp",P="Sony",A="Xiaomi",F="Zebra",j="Facebook",U=function(e){for(var t={},n=0;n<e.length;n++)t[e[n].toUpperCase()]=e[n];return t},q=function(e,t){return typeof e===a&&-1!==B(t).indexOf(B(e))},B=function(e){return e.toLowerCase()},W=function(e,t){if(typeof e===a)return e=e.replace(/^\s\s*/,""),typeof t===o?e:e.substring(0,350)},z=function(e,t){for(var n,o,a,c,l,u,d=0;d<t.length&&!l;){var p=t[d],h=t[d+1];for(n=o=0;n<p.length&&!l;)if(l=p[n++].exec(e))for(a=0;a<h.length;a++)u=l[++o],typeof(c=h[a])===s&&c.length>0?2===c.length?typeof c[1]==i?this[c[0]]=c[1].call(this,u):this[c[0]]=c[1]:3===c.length?typeof c[1]!==i||c[1].exec&&c[1].test?this[c[0]]=u?u.replace(c[1],c[2]):r:this[c[0]]=u?c[1].call(this,u,c[2]):r:4===c.length&&(this[c[0]]=u?c[3].call(this,u.replace(c[1],c[2])):r):this[c]=u||r;d+=2}},G=function(e,t){for(var n in t)if(typeof t[n]===s&&t[n].length>0){for(var i=0;i<t[n].length;i++)if(q(t[n][i],e))return"?"===n?r:n}else if(q(t[n],e))return"?"===n?r:n;return e},V={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},K={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[p,[l,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[p,[l,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[l,p],[/opios[\/ ]+([\w\.]+)/i],[p,[l,D+" Mini"]],[/\bopr\/([\w\.]+)/i],[p,[l,D]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[l,p],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[p,[l,"UC"+C]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[p,[l,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[p,[l,"WeChat"]],[/konqueror\/([\w\.]+)/i],[p,[l,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[p,[l,"IE"]],[/yabrowser\/([\w\.]+)/i],[p,[l,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[l,/(.+)/,"$1 Secure "+C],p],[/\bfocus\/([\w\.]+)/i],[p,[l,x+" Focus"]],[/\bopt\/([\w\.]+)/i],[p,[l,D+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[p,[l,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[p,[l,"Dolphin"]],[/coast\/([\w\.]+)/i],[p,[l,D+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[p,[l,"MIUI "+C]],[/fxios\/([-\w\.]+)/i],[p,[l,x]],[/\bqihu|(qi?ho?o?|360)browser/i],[[l,"360 "+C]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[l,/(.+)/,"$1 "+C],p],[/(comodo_dragon)\/([\w\.]+)/i],[[l,/_/g," "],p],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[l,p],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[l],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[l,j],p],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[l,p],[/\bgsa\/([\w\.]+) .*safari\//i],[p,[l,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[p,[l,M+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[l,M+" WebView"],p],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[p,[l,"Android "+C]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[l,p],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[p,[l,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[p,l],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[l,[p,G,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[l,p],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[l,"Netscape"],p],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[p,[l,x+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[l,p],[/(cobalt)\/([\w\.]+)/i],[l,[p,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[h,"amd64"]],[/(ia32(?=;))/i],[[h,B]],[/((?:i[346]|x)86)[;\)]/i],[[h,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[h,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[h,"armhf"]],[/windows (ce|mobile); ppc;/i],[[h,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[h,/ower/,"",B]],[/(sun4\w)[;\)]/i],[[h,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[h,B]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[c,[d,N],[u,m]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[c,[d,N],[u,v]],[/((ipod|iphone)\d+,\d+)/i],[c,[d,S],[u,v]],[/(ipad\d+,\d+)/i],[c,[d,S],[u,m]],[/\((ip(?:hone|od)[\w ]*);/i],[c,[d,S],[u,v]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[c,[d,S],[u,m]],[/(macintosh);/i],[c,[d,S]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[c,[d,O],[u,m]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[c,[d,O],[u,v]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[c,/_/g," "],[d,A],[u,v]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[c,/_/g," "],[d,A],[u,m]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[c,[d,"OPPO"],[u,v]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[c,[d,"Vivo"],[u,v]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[c,[d,"Realme"],[u,v]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[c,[d,_],[u,v]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[c,[d,_],[u,m]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[c,[d,T],[u,m]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[c,[d,T],[u,v]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[c,[d,"Lenovo"],[u,m]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[c,/_/g," "],[d,"Nokia"],[u,v]],[/(pixel c)\b/i],[c,[d,E],[u,m]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[c,[d,E],[u,v]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[c,[d,P],[u,v]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[c,"Xperia Tablet"],[d,P],[u,m]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[c,[d,"OnePlus"],[u,v]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[c,[d,w],[u,m]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[c,/(.+)/g,"Fire Phone $1"],[d,w],[u,v]],[/(playbook);[-\w\),; ]+(rim)/i],[c,d,[u,m]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[c,[d,k],[u,v]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[c,[d,I],[u,m]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[c,[d,I],[u,v]],[/(nexus 9)/i],[c,[d,"HTC"],[u,m]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony(?!-bra))[-_ ]?([-\w]*)/i],[d,[c,/_/g," "],[u,v]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[c,[d,"Acer"],[u,m]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[c,[d,"Meizu"],[u,v]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[c,[d,L],[u,v]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[d,c,[u,v]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[d,c,[u,m]],[/(surface duo)/i],[c,[d,R],[u,m]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[c,[d,"Fairphone"],[u,v]],[/(u304aa)/i],[c,[d,"AT&T"],[u,v]],[/\bsie-(\w*)/i],[c,[d,"Siemens"],[u,v]],[/\b(rct\w+) b/i],[c,[d,"RCA"],[u,m]],[/\b(venue[\d ]{2,7}) b/i],[c,[d,"Dell"],[u,m]],[/\b(q(?:mv|ta)\w+) b/i],[c,[d,"Verizon"],[u,m]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[c,[d,"Barnes & Noble"],[u,m]],[/\b(tm\d{3}\w+) b/i],[c,[d,"NuVision"],[u,m]],[/\b(k88) b/i],[c,[d,"ZTE"],[u,m]],[/\b(nx\d{3}j) b/i],[c,[d,"ZTE"],[u,v]],[/\b(gen\d{3}) b.+49h/i],[c,[d,"Swiss"],[u,v]],[/\b(zur\d{3}) b/i],[c,[d,"Swiss"],[u,m]],[/\b((zeki)?tb.*\b) b/i],[c,[d,"Zeki"],[u,m]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[d,"Dragon Touch"],c,[u,m]],[/\b(ns-?\w{0,9}) b/i],[c,[d,"Insignia"],[u,m]],[/\b((nxa|next)-?\w{0,9}) b/i],[c,[d,"NextBook"],[u,m]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[d,"Voice"],c,[u,v]],[/\b(lvtel\-)?(v1[12]) b/i],[[d,"LvTel"],c,[u,v]],[/\b(ph-1) /i],[c,[d,"Essential"],[u,v]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[c,[d,"Envizen"],[u,m]],[/\b(trio[-\w\. ]+) b/i],[c,[d,"MachSpeed"],[u,m]],[/\btu_(1491) b/i],[c,[d,"Rotor"],[u,m]],[/(shield[\w ]+) b/i],[c,[d,"Nvidia"],[u,m]],[/(sprint) (\w+)/i],[d,c,[u,v]],[/(kin\.[onetw]{3})/i],[[c,/\./g," "],[d,R],[u,v]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[c,[d,F],[u,m]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[c,[d,F],[u,v]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[d,c,[u,f]],[/droid.+; (shield) bui/i],[c,[d,"Nvidia"],[u,f]],[/(playstation [345portablevi]+)/i],[c,[d,P],[u,f]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[c,[d,R],[u,f]],[/smart-tv.+(samsung)/i],[d,[u,g]],[/hbbtv.+maple;(\d+)/i],[[c,/^/,"SmartTV"],[d,N],[u,g]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[d,T],[u,g]],[/(apple) ?tv/i],[d,[c,S+" TV"],[u,g]],[/crkey/i],[[c,M+"cast"],[d,E],[u,g]],[/droid.+aft(\w)( bui|\))/i],[c,[d,w],[u,g]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[c,[d,L],[u,g]],[/(bravia[\w ]+)( bui|\))/i],[c,[d,P],[u,g]],[/(mitv-\w{5}) bui/i],[c,[d,A],[u,g]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[d,W],[c,W],[u,g]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[u,g]],[/((pebble))app/i],[d,c,[u,y]],[/droid.+; (glass) \d/i],[c,[d,E],[u,y]],[/droid.+; (wt63?0{2,3})\)/i],[c,[d,F],[u,y]],[/(quest( 2)?)/i],[c,[d,j],[u,y]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[d,[u,b]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[c,[u,v]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[c,[u,m]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[u,m]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[u,v]],[/(android[-\w\. ]{0,9});.+buil/i],[c,[d,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[p,[l,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[p,[l,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[l,p],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[p,l]],os:[[/microsoft (windows) (vista|xp)/i],[l,p],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[l,[p,G,V]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[l,"Windows"],[p,G,V]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[p,/_/g,"."],[l,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[l,"Mac OS"],[p,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[p,l],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[l,p],[/\(bb(10);/i],[p,[l,k]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[p,[l,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[p,[l,x+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[p,[l,"webOS"]],[/crkey\/([\d\.]+)/i],[p,[l,M+"cast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[l,"Chromium OS"],p],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[l,p],[/(sunos) ?([\w\.\d]*)/i],[[l,"Solaris"],p],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[l,p]]},H=function(e,t){if(typeof e===s&&(t=e,e=r),!(this instanceof H))return new H(e,t).getResult();var i=e||(typeof n!==o&&n.navigator&&n.navigator.userAgent?n.navigator.userAgent:""),f=t?function(e,t){var n={};for(var r in e)t[r]&&t[r].length%2==0?n[r]=t[r].concat(e[r]):n[r]=e[r];return n}(K,t):K;return this.getBrowser=function(){var e,t={};return t[l]=r,t[p]=r,z.call(t,i,f.browser),t.major=typeof(e=t.version)===a?e.replace(/[^\d\.]/g,"").split(".")[0]:r,t},this.getCPU=function(){var e={};return e[h]=r,z.call(e,i,f.cpu),e},this.getDevice=function(){var e={};return e[d]=r,e[c]=r,e[u]=r,z.call(e,i,f.device),e},this.getEngine=function(){var e={};return e[l]=r,e[p]=r,z.call(e,i,f.engine),e},this.getOS=function(){var e={};return e[l]=r,e[p]=r,z.call(e,i,f.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(e){return i=typeof e===a&&e.length>350?W(e,350):e,this},this.setUA(i),this};H.VERSION="0.7.33",H.BROWSER=U([l,p,"major"]),H.CPU=U([h]),H.DEVICE=U([c,d,u,f,v,g,m,y,b]),H.ENGINE=H.OS=U([l,p]),e.exports&&(t=e.exports=H),t.UAParser=H;var Z=typeof n!==o&&(n.jQuery||n.Zepto);if(Z&&!Z.ua){var $=new H;Z.ua=$.getResult(),Z.ua.get=function(){return $.getUA()},Z.ua.set=function(e){$.setUA(e);var t=$.getResult();for(var n in t)Z.ua[n]=t[n]}}}("object"==typeof window?window:o)}(s,s.exports);var a=s.exports,c=function(e){var n=this;void 0===e&&(e={});var o,s=e.osName,c=void 0===s||s,l=e.osVersion,u=void 0===l||l,d=e.deviceManufacturer,p=void 0===d||d,h=e.deviceModel,f=void 0===h||h;return{name:"@amplitude/plugin-user-agent-enrichment-browser",type:"enrichment",setup:function(e){return r(this,void 0,void 0,(function(){var t;return i(this,(function(n){return"undefined"!=typeof navigator&&(t=navigator.userAgent),o=new a(t).getResult(),e.loggerProvider.log("Installing @amplitude/plugin-user-agent-enrichment-browser."),[2]}))}))},execute:function(e){return r(n,void 0,void 0,(function(){var n,r,s,a;return i(this,(function(i){return n=o.browser.name,r=o.browser.version,s=o.device.model||o.os.name,a=o.device.vendor,[2,t(t(t(t(t({},e),c&&{os_name:n}),u&&{os_version:r}),p&&{device_manufacturer:a}),f&&{device_model:s})]}))}))}}};return e.plugin=c,e.userAgentEnrichmentPlugin=c,Object.defineProperty(e,"__esModule",{value:!0}),e}({}),o=function(e){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},t(e,n)};function r(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var i,o,s,a=function(){return a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},a.apply(this,arguments)};function c(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}function l(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}function u(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function d(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function p(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}!function(e){e[e.None=0]="None",e[e.Error=1]="Error",e[e.Warn=2]="Warn",e[e.Verbose=3]="Verbose",e[e.Debug=4]="Debug"}(i||(i={})),function(e){e.US="US",e.EU="EU",e.STAGING="STAGING"}(o||(o={})),function(e){e.Unknown="unknown",e.Skipped="skipped",e.Success="success",e.RateLimit="rate_limit",e.PayloadTooLarge="payload_too_large",e.Invalid="invalid",e.Failed="failed",e.Timeout="Timeout",e.SystemError="SystemError"}(s||(s={}));var h="".concat("AMP","_unsent"),f="https://api2.amplitude.com/2/httpapi",v=function(e){return{promise:e||Promise.resolve()}},m="Amplitude Logger ",g=function(){function e(){this.logLevel=i.None}return e.prototype.disable=function(){this.logLevel=i.None},e.prototype.enable=function(e){void 0===e&&(e=i.Warn),this.logLevel=e},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.logLevel<i.Verbose||console.log("".concat(m,"[Log]: ").concat(e.join(" ")))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.logLevel<i.Warn||console.warn("".concat(m,"[Warn]: ").concat(e.join(" ")))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.logLevel<i.Error||console.error("".concat(m,"[Error]: ").concat(e.join(" ")))},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.logLevel<i.Debug||console.log("".concat(m,"[Debug]: ").concat(e.join(" ")))},e}(),y=function(){return{flushMaxRetries:12,flushQueueSize:200,flushIntervalMillis:1e4,instanceName:"$default_instance",logLevel:i.Warn,loggerProvider:new g,optOut:!1,serverUrl:f,serverZone:o.US,useBatch:!1}},b=function(){function e(e){var t,n,r,i;this._optOut=!1;var o=y();this.apiKey=e.apiKey,this.flushIntervalMillis=null!==(t=e.flushIntervalMillis)&&void 0!==t?t:o.flushIntervalMillis,this.flushMaxRetries=e.flushMaxRetries||o.flushMaxRetries,this.flushQueueSize=e.flushQueueSize||o.flushQueueSize,this.instanceName=e.instanceName||o.instanceName,this.loggerProvider=e.loggerProvider||o.loggerProvider,this.logLevel=null!==(n=e.logLevel)&&void 0!==n?n:o.logLevel,this.minIdLength=e.minIdLength,this.plan=e.plan,this.ingestionMetadata=e.ingestionMetadata,this.optOut=null!==(r=e.optOut)&&void 0!==r?r:o.optOut,this.serverUrl=e.serverUrl,this.serverZone=e.serverZone||o.serverZone,this.storageProvider=e.storageProvider,this.transportProvider=e.transportProvider,this.useBatch=null!==(i=e.useBatch)&&void 0!==i?i:o.useBatch,this.loggerProvider.enable(this.logLevel);var s=S(e.serverUrl,e.serverZone,e.useBatch);this.serverZone=s.serverZone,this.serverUrl=s.serverUrl}return Object.defineProperty(e.prototype,"optOut",{get:function(){return this._optOut},set:function(e){this._optOut=e},enumerable:!1,configurable:!0}),e}(),w=function(e,t){return e===o.EU?t?"https://api.eu.amplitude.com/batch":"https://api.eu.amplitude.com/2/httpapi":t?"https://api2.amplitude.com/batch":f},S=function(e,t,n){if(void 0===e&&(e=""),void 0===t&&(t=y().serverZone),void 0===n&&(n=y().useBatch),e)return{serverUrl:e,serverZone:void 0};var r=["US","EU"].includes(t)?t:y().serverZone;return{serverZone:r,serverUrl:w(r,n)}},I=function(e){return void 0===e&&(e=0),((new Error).stack||"").split("\n").slice(2+e).map((function(e){return e.trim()}))},k=function(e,t,n,r,o){return void 0===o&&(o=null),function(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];var c=n(),l=c.logger,u=c.logLevel;if(u&&u<i.Debug||!u||!l)return e.apply(o,s);var d={type:"invoke public method",name:t,args:s,stacktrace:I(1),time:{start:(new Date).toISOString()},states:{}};r&&d.states&&(d.states.before=r());var p=e.apply(o,s);return p&&p.promise?p.promise.then((function(){r&&d.states&&(d.states.after=r()),d.time&&(d.time.end=(new Date).toISOString()),l.debug(JSON.stringify(d,null,2))})):(r&&d.states&&(d.states.after=r()),d.time&&(d.time.end=(new Date).toISOString()),l.debug(JSON.stringify(d,null,2))),p}},C=function(){function e(){}return e.prototype.send=function(e,t){return Promise.resolve(null)},e.prototype.buildResponse=function(e){var t,n,r,i,o,a,c,l,u,d,p,h,f,v,m,g,y,b,w,S,I,k;if("object"!=typeof e)return null;var C=e.code||0,M=this.buildStatus(C);switch(M){case s.Success:return{status:M,statusCode:C,body:{eventsIngested:null!==(t=e.events_ingested)&&void 0!==t?t:0,payloadSizeBytes:null!==(n=e.payload_size_bytes)&&void 0!==n?n:0,serverUploadTime:null!==(r=e.server_upload_time)&&void 0!==r?r:0}};case s.Invalid:return{status:M,statusCode:C,body:{error:null!==(i=e.error)&&void 0!==i?i:"",missingField:null!==(o=e.missing_field)&&void 0!==o?o:"",eventsWithInvalidFields:null!==(a=e.events_with_invalid_fields)&&void 0!==a?a:{},eventsWithMissingFields:null!==(c=e.events_with_missing_fields)&&void 0!==c?c:{},eventsWithInvalidIdLengths:null!==(l=e.events_with_invalid_id_lengths)&&void 0!==l?l:{},epsThreshold:null!==(u=e.eps_threshold)&&void 0!==u?u:0,exceededDailyQuotaDevices:null!==(d=e.exceeded_daily_quota_devices)&&void 0!==d?d:{},silencedDevices:null!==(p=e.silenced_devices)&&void 0!==p?p:[],silencedEvents:null!==(h=e.silenced_events)&&void 0!==h?h:[],throttledDevices:null!==(f=e.throttled_devices)&&void 0!==f?f:{},throttledEvents:null!==(v=e.throttled_events)&&void 0!==v?v:[]}};case s.PayloadTooLarge:return{status:M,statusCode:C,body:{error:null!==(m=e.error)&&void 0!==m?m:""}};case s.RateLimit:return{status:M,statusCode:C,body:{error:null!==(g=e.error)&&void 0!==g?g:"",epsThreshold:null!==(y=e.eps_threshold)&&void 0!==y?y:0,throttledDevices:null!==(b=e.throttled_devices)&&void 0!==b?b:{},throttledUsers:null!==(w=e.throttled_users)&&void 0!==w?w:{},exceededDailyQuotaDevices:null!==(S=e.exceeded_daily_quota_devices)&&void 0!==S?S:{},exceededDailyQuotaUsers:null!==(I=e.exceeded_daily_quota_users)&&void 0!==I?I:{},throttledEvents:null!==(k=e.throttled_events)&&void 0!==k?k:[]}};case s.Timeout:default:return{status:M,statusCode:C}}},e.prototype.buildStatus=function(e){return e>=200&&e<300?s.Success:429===e?s.RateLimit:413===e?s.PayloadTooLarge:408===e?s.Timeout:e>=400&&e<500?s.Invalid:e>=500?s.Failed:s.Unknown},e}(),M=function(){function e(){}return e.prototype.getApplicationContext=function(){return{versionName:this.versionName,language:x(),platform:"Web",os:void 0,deviceModel:void 0}},e}(),x=function(){return"undefined"!=typeof navigator&&(navigator.languages&&navigator.languages[0]||navigator.language)||""},E=function(){function e(){this.queue=[]}return e.prototype.logEvent=function(e){this.receiver?this.receiver(e):this.queue.length<512&&this.queue.push(e)},e.prototype.setEventReceiver=function(e){this.receiver=e,this.queue.length>0&&(this.queue.forEach((function(t){e(t)})),this.queue=[])},e}(),O=function(){return O=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},O.apply(this,arguments)},T=function(e,t){var n=typeof e;if(n!==typeof t)return!1;for(var r=0,i=["string","number","boolean","undefined"];r<i.length;r++)if(i[r]===n)return e===t;if(null==e&&null==t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;var o=Array.isArray(e),s=Array.isArray(t);if(o!==s)return!1;if(!o||!s){var a=Object.keys(e).sort(),c=Object.keys(t).sort();if(!T(a,c))return!1;var l=!0;return Object.keys(e).forEach((function(n){T(e[n],t[n])||(l=!1)})),l}for(var u=0;u<e.length;u++)if(!T(e[u],t[u]))return!1;return!0};Object.entries||(Object.entries=function(e){for(var t=Object.keys(e),n=t.length,r=new Array(n);n--;)r[n]=[t[n],e[t[n]]];return r});var R,_=function(){function e(){this.identity={userProperties:{}},this.listeners=new Set}return e.prototype.editIdentity=function(){var e=this,t=O({},this.identity.userProperties),n=O(O({},this.identity),{userProperties:t});return{setUserId:function(e){return n.userId=e,this},setDeviceId:function(e){return n.deviceId=e,this},setUserProperties:function(e){return n.userProperties=e,this},setOptOut:function(e){return n.optOut=e,this},updateUserProperties:function(e){for(var t=n.userProperties||{},r=0,i=Object.entries(e);r<i.length;r++){var o=i[r],s=o[0],a=o[1];switch(s){case"$set":for(var c=0,l=Object.entries(a);c<l.length;c++){var u=l[c],d=u[0],p=u[1];t[d]=p}break;case"$unset":for(var h=0,f=Object.keys(a);h<f.length;h++)delete t[d=f[h]];break;case"$clearAll":t={}}}return n.userProperties=t,this},commit:function(){return e.setIdentity(n),this}}},e.prototype.getIdentity=function(){return O({},this.identity)},e.prototype.setIdentity=function(e){var t=O({},this.identity);this.identity=O({},e),T(t,this.identity)||this.listeners.forEach((function(t){t(e)}))},e.prototype.addIdentityListener=function(e){this.listeners.add(e)},e.prototype.removeIdentityListener=function(e){this.listeners.delete(e)},e}(),D="undefined"!=typeof globalThis?globalThis:void 0!==n.g?n.g:self,N=function(){function e(){this.identityStore=new _,this.eventBridge=new E,this.applicationContextProvider=new M}return e.getInstance=function(t){return D.analyticsConnectorInstances||(D.analyticsConnectorInstances={}),D.analyticsConnectorInstances[t]||(D.analyticsConnectorInstances[t]=new e),D.analyticsConnectorInstances[t]},e}(),L=function(e){return void 0===e&&(e="$default_instance"),N.getInstance(e)},P=function(){return"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0!==n.g?n.g:void 0},A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.send=function(e,t){return c(this,void 0,void 0,(function(){var n,r,i;return l(this,(function(o){switch(o.label){case 0:if("undefined"==typeof fetch)throw new Error("FetchTransport is not supported");return n={headers:{"Content-Type":"application/json",Accept:"*/*"},body:JSON.stringify(t),method:"POST"},[4,fetch(e,n)];case 1:return[4,(r=o.sent()).text()];case 2:i=o.sent();try{return[2,this.buildResponse(JSON.parse(i))]}catch(e){return[2,this.buildResponse({code:r.status})]}return[2]}}))}))},t}(C),F="[Amplitude]",j="".concat(F," Session Replay ID"),U=o.US,q="".concat(F," Session Replay Debug"),B="amp-mask",W=function(){return{flushMaxRetries:2,logLevel:i.Warn,loggerProvider:new g,transportProvider:new A}},z=function(e){function t(t,n){var r=this,i=W();return(r=e.call(this,a(a({transportProvider:i.transportProvider},n),{apiKey:t}))||this).flushMaxRetries=void 0!==n.flushMaxRetries&&n.flushMaxRetries<=i.flushMaxRetries?n.flushMaxRetries:i.flushMaxRetries,r.apiKey=t,r.sampleRate=n.sampleRate||0,r.serverZone=n.serverZone||U,r.configEndpointUrl=n.configEndpointUrl,n.privacyConfig&&(r.privacyConfig=n.privacyConfig),n.debugMode&&(r.debugMode=n.debugMode),r}return r(t,e),t}(b);function G(e){var t=null==e?void 0:e.host;return Boolean((null==t?void 0:t.shadowRoot)===e)}function V(e){return"[object ShadowRoot]"===Object.prototype.toString.call(e)}function K(e){try{var t=e.rules||e.cssRules;return t?((n=Array.from(t,H).join("")).includes(" background-clip: text;")&&!n.includes(" -webkit-background-clip: text;")&&(n=n.replace(" background-clip: text;"," -webkit-background-clip: text; background-clip: text;")),n):null}catch(e){return null}var n}function H(e){var t,n;if(function(e){return"styleSheet"in e}(e))try{t=K(e.styleSheet)||function(e){var t=e.cssText;if(t.split('"').length<3)return t;var n=["@import","url(".concat(JSON.stringify(e.href),")")];return""===e.layerName?n.push("layer"):e.layerName&&n.push("layer(".concat(e.layerName,")")),e.supportsText&&n.push("supports(".concat(e.supportsText,")")),e.media.length&&n.push(e.media.mediaText),n.join(" ")+";"}(e)}catch(e){}else if(function(e){return"selectorText"in e}(e)&&e.selectorText.includes(":"))return n=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm,e.cssText.replace(n,"$1\\$2");return t||e.cssText}!function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"}(R||(R={}));var Z=function(){function e(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}return e.prototype.getId=function(e){var t;if(!e)return-1;var n=null===(t=this.getMeta(e))||void 0===t?void 0:t.id;return null!=n?n:-1},e.prototype.getNode=function(e){return this.idNodeMap.get(e)||null},e.prototype.getIds=function(){return Array.from(this.idNodeMap.keys())},e.prototype.getMeta=function(e){return this.nodeMetaMap.get(e)||null},e.prototype.removeNodeFromMap=function(e){var t=this,n=this.getId(e);this.idNodeMap.delete(n),e.childNodes&&e.childNodes.forEach((function(e){return t.removeNodeFromMap(e)}))},e.prototype.has=function(e){return this.idNodeMap.has(e)},e.prototype.hasNode=function(e){return this.nodeMetaMap.has(e)},e.prototype.add=function(e,t){var n=t.id;this.idNodeMap.set(n,e),this.nodeMetaMap.set(e,t)},e.prototype.replace=function(e,t){var n=this.getNode(e);if(n){var r=this.nodeMetaMap.get(n);r&&this.nodeMetaMap.set(t,r)}this.idNodeMap.set(e,t)},e.prototype.reset=function(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap},e}();function $(e){var t=e.element,n=e.maskInputOptions,r=e.tagName,i=e.type,o=e.value,s=e.maskInputFn,a=o||"",c=i&&J(i);return(n[r.toLowerCase()]||c&&n[c])&&(a=s?s(a,t):"*".repeat(a.length)),a}function J(e){return e.toLowerCase()}var X="__rrweb_original__";function Q(e){var t=e.type;return e.hasAttribute("data-rr-is-password")?"password":t?J(t):null}var Y,ee,te=1,ne=new RegExp("[^a-z0-9-_:]");function re(){return te++}var ie=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,oe=/^(?:[a-z+]+:)?\/\//i,se=/^www\..*/i,ae=/^(data:)([^,]*),(.*)/i;function ce(e,t){return(e||"").replace(ie,(function(e,n,r,i,o,s){var a,c=r||o||s,l=n||i||"";if(!c)return e;if(oe.test(c)||se.test(c))return"url(".concat(l).concat(c).concat(l,")");if(ae.test(c))return"url(".concat(l).concat(c).concat(l,")");if("/"===c[0])return"url(".concat(l).concat((a=t,(a.indexOf("//")>-1?a.split("/").slice(0,3).join("/"):a.split("/")[0]).split("?")[0]+c)).concat(l,")");var u=t.split("/"),d=c.split("/");u.pop();for(var p=0,h=d;p<h.length;p++){var f=h[p];"."!==f&&(".."===f?u.pop():u.push(f))}return"url(".concat(l).concat(u.join("/")).concat(l,")")}))}var le=/^[^ \t\n\r\u000c]+/,ue=/^[, \t\n\r\u000c]+/;function de(e,t){if(!t||""===t.trim())return t;var n=e.createElement("a");return n.href=t,n.href}function pe(e){return Boolean("svg"===e.tagName||e.ownerSVGElement)}function he(){var e=document.createElement("a");return e.href="",e.href}function fe(e,t,n,r){return r?"src"===n||"href"===n&&("use"!==t||"#"!==r[0])||"xlink:href"===n&&"#"!==r[0]?de(e,r):"background"!==n||"table"!==t&&"td"!==t&&"th"!==t?"srcset"===n?function(e,t){if(""===t.trim())return t;var n=0;function r(e){var r,i=e.exec(t.substring(n));return i?(r=i[0],n+=r.length,r):""}for(var i=[];r(ue),!(n>=t.length);){var o=r(le);if(","===o.slice(-1))o=de(e,o.substring(0,o.length-1)),i.push(o);else{var s="";o=de(e,o);for(var a=!1;;){var c=t.charAt(n);if(""===c){i.push((o+s).trim());break}if(a)")"===c&&(a=!1);else{if(","===c){n+=1,i.push((o+s).trim());break}"("===c&&(a=!0)}s+=c,n+=1}}}return i.join(", ")}(e,r):"style"===n?ce(r,he()):"object"===t&&"data"===n?de(e,r):r:de(e,r):r}function ve(e,t,n){return("video"===e||"audio"===e)&&"autoplay"===t}function me(e,t,n){if(!e)return!1;if(e.nodeType!==e.ELEMENT_NODE)return!!n&&me(e.parentNode,t,n);for(var r=e.classList.length;r--;){var i=e.classList[r];if(t.test(i))return!0}return!!n&&me(e.parentNode,t,n)}function ge(e,t,n){try{var r=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(null===r)return!1;if("string"==typeof t){if(r.classList.contains(t))return!0;if(r.closest(".".concat(t)))return!0}else if(me(r,t,!0))return!0;if(n){if(r.matches(n))return!0;if(r.closest(n))return!0}}catch(e){}return!1}function ye(e,t){var n=t.doc,r=t.mirror,i=t.blockClass,o=t.blockSelector,s=t.maskTextClass,a=t.maskTextSelector,c=t.inlineStylesheet,l=t.maskInputOptions,u=void 0===l?{}:l,d=t.maskTextFn,p=t.maskInputFn,h=t.dataURLOptions,f=void 0===h?{}:h,v=t.inlineImages,m=t.recordCanvas,g=t.keepIframeSrcFn,y=t.newlyAddedElement,b=void 0!==y&&y,w=function(e,t){if(t.hasNode(e)){var n=t.getId(e);return 1===n?void 0:n}}(n,r);switch(e.nodeType){case e.DOCUMENT_NODE:return"CSS1Compat"!==e.compatMode?{type:R.Document,childNodes:[],compatMode:e.compatMode}:{type:R.Document,childNodes:[]};case e.DOCUMENT_TYPE_NODE:return{type:R.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId,rootId:w};case e.ELEMENT_NODE:return function(e,t){for(var n=t.doc,r=t.inlineStylesheet,i=t.maskInputOptions,o=void 0===i?{}:i,s=t.maskInputFn,a=t.dataURLOptions,c=void 0===a?{}:a,l=t.inlineImages,u=t.recordCanvas,d=t.keepIframeSrcFn,p=t.newlyAddedElement,h=void 0!==p&&p,f=t.rootId,v=function(e,t,n){try{if("string"==typeof t){if(e.classList.contains(t))return!0}else for(var r=e.classList.length;r--;){var i=e.classList[r];if(t.test(i))return!0}if(n)return e.matches(n)}catch(e){}return!1}(e,t.blockClass,t.blockSelector),m=function(e){if(e instanceof HTMLFormElement)return"form";var t=J(e.tagName);return ne.test(t)?"div":t}(e),g={},y=e.attributes.length,b=0;b<y;b++){var w=e.attributes[b];ve(m,w.name,w.value)||(g[w.name]=fe(n,m,J(w.name),w.value))}if("link"===m&&r){var S=Array.from(n.styleSheets).find((function(t){return t.href===e.href})),I=null;S&&(I=K(S)),I&&(delete g.rel,delete g.href,g._cssText=ce(I,S.href))}if("style"===m&&e.sheet&&!(e.innerText||e.textContent||"").trim().length&&(I=K(e.sheet))&&(g._cssText=ce(I,he())),"input"===m||"textarea"===m||"select"===m){var k=e.value,C=e.checked;if("radio"!==g.type&&"checkbox"!==g.type&&"submit"!==g.type&&"button"!==g.type&&k){var M=Q(e);g.value=$({element:e,type:M,tagName:m,value:k,maskInputOptions:o,maskInputFn:s})}else C&&(g.checked=C)}if("option"===m&&(e.selected&&!o.select?g.selected=!0:delete g.selected),"canvas"===m&&u)if("2d"===e.__context)(function(e){var t=e.getContext("2d");if(!t)return!0;for(var n=0;n<e.width;n+=50)for(var r=0;r<e.height;r+=50){var i=t.getImageData,o=X in i?i[X]:i;if(new Uint32Array(o.call(t,n,r,Math.min(50,e.width-n),Math.min(50,e.height-r)).data.buffer).some((function(e){return 0!==e})))return!1}return!0})(e)||(g.rr_dataURL=e.toDataURL(c.type,c.quality));else if(!("__context"in e)){var x=e.toDataURL(c.type,c.quality),E=document.createElement("canvas");E.width=e.width,E.height=e.height,x!==E.toDataURL(c.type,c.quality)&&(g.rr_dataURL=x)}if("img"===m&&l){Y||(Y=n.createElement("canvas"),ee=Y.getContext("2d"));var O=e,T=O.crossOrigin;O.crossOrigin="anonymous";var _=function(){O.removeEventListener("load",_);try{Y.width=O.naturalWidth,Y.height=O.naturalHeight,ee.drawImage(O,0,0),g.rr_dataURL=Y.toDataURL(c.type,c.quality)}catch(e){console.warn("Cannot inline img src=".concat(O.currentSrc,"! Error: ").concat(e))}T?g.crossOrigin=T:O.removeAttribute("crossorigin")};O.complete&&0!==O.naturalWidth?_():O.addEventListener("load",_)}if("audio"!==m&&"video"!==m||(g.rr_mediaState=e.paused?"paused":"played",g.rr_mediaCurrentTime=e.currentTime),h||(e.scrollLeft&&(g.rr_scrollLeft=e.scrollLeft),e.scrollTop&&(g.rr_scrollTop=e.scrollTop)),v){var D=e.getBoundingClientRect(),N=D.width,L=D.height;g={class:g.class,rr_width:"".concat(N,"px"),rr_height:"".concat(L,"px")}}return"iframe"!==m||d(g.src)||(e.contentDocument||(g.rr_src=g.src),delete g.src),{type:R.Element,tagName:m,attributes:g,childNodes:[],isSVG:pe(e)||void 0,needBlock:v,rootId:f}}(e,{doc:n,blockClass:i,blockSelector:o,inlineStylesheet:c,maskInputOptions:u,maskInputFn:p,dataURLOptions:f,inlineImages:v,recordCanvas:m,keepIframeSrcFn:g,newlyAddedElement:b,rootId:w});case e.TEXT_NODE:return function(e,t){var n,r=t.maskTextClass,i=t.maskTextSelector,o=t.maskTextFn,s=t.rootId,a=e.parentNode&&e.parentNode.tagName,c=e.textContent,l="STYLE"===a||void 0,u="SCRIPT"===a||void 0;if(l&&c){try{e.nextSibling||e.previousSibling||(null===(n=e.parentNode.sheet)||void 0===n?void 0:n.cssRules)&&(c=K(e.parentNode.sheet))}catch(t){console.warn("Cannot get CSS styles from text's parentNode. Error: ".concat(t),e)}c=ce(c,he())}return u&&(c="SCRIPT_PLACEHOLDER"),!l&&!u&&c&&ge(e,r,i)&&(c=o?o(c,e.parentElement):c.replace(/[\S]/g,"*")),{type:R.Text,textContent:c||"",isStyle:l,rootId:s}}(e,{maskTextClass:s,maskTextSelector:a,maskTextFn:d,rootId:w});case e.CDATA_SECTION_NODE:return{type:R.CDATA,textContent:"",rootId:w};case e.COMMENT_NODE:return{type:R.Comment,textContent:e.textContent||"",rootId:w};default:return!1}}function be(e){return null==e?"":e.toLowerCase()}function we(e,t){var n,r=t.doc,i=t.mirror,o=t.blockClass,s=t.blockSelector,a=t.maskTextClass,c=t.maskTextSelector,l=t.skipChild,u=void 0!==l&&l,d=t.inlineStylesheet,p=void 0===d||d,h=t.maskInputOptions,f=void 0===h?{}:h,v=t.maskTextFn,m=t.maskInputFn,g=t.slimDOMOptions,y=t.dataURLOptions,b=void 0===y?{}:y,w=t.inlineImages,S=void 0!==w&&w,I=t.recordCanvas,k=void 0!==I&&I,C=t.onSerialize,M=t.onIframeLoad,x=t.iframeLoadTimeout,E=void 0===x?5e3:x,O=t.onStylesheetLoad,T=t.stylesheetLoadTimeout,_=void 0===T?5e3:T,D=t.keepIframeSrcFn,N=void 0===D?function(){return!1}:D,L=t.newlyAddedElement,P=void 0!==L&&L,A=t.preserveWhiteSpace,F=void 0===A||A,j=ye(e,{doc:r,mirror:i,blockClass:o,blockSelector:s,maskTextClass:a,maskTextSelector:c,inlineStylesheet:p,maskInputOptions:f,maskTextFn:v,maskInputFn:m,dataURLOptions:b,inlineImages:S,recordCanvas:k,keepIframeSrcFn:N,newlyAddedElement:P});if(!j)return console.warn(e,"not serialized"),null;n=i.hasNode(e)?i.getId(e):!function(e,t){if(t.comment&&e.type===R.Comment)return!0;if(e.type===R.Element){if(t.script&&("script"===e.tagName||"link"===e.tagName&&("preload"===e.attributes.rel||"modulepreload"===e.attributes.rel)&&"script"===e.attributes.as||"link"===e.tagName&&"prefetch"===e.attributes.rel&&"string"==typeof e.attributes.href&&e.attributes.href.endsWith(".js")))return!0;if(t.headFavicon&&("link"===e.tagName&&"shortcut icon"===e.attributes.rel||"meta"===e.tagName&&(be(e.attributes.name).match(/^msapplication-tile(image|color)$/)||"application-name"===be(e.attributes.name)||"icon"===be(e.attributes.rel)||"apple-touch-icon"===be(e.attributes.rel)||"shortcut icon"===be(e.attributes.rel))))return!0;if("meta"===e.tagName){if(t.headMetaDescKeywords&&be(e.attributes.name).match(/^description|keywords$/))return!0;if(t.headMetaSocial&&(be(e.attributes.property).match(/^(og|twitter|fb):/)||be(e.attributes.name).match(/^(og|twitter):/)||"pinterest"===be(e.attributes.name)))return!0;if(t.headMetaRobots&&("robots"===be(e.attributes.name)||"googlebot"===be(e.attributes.name)||"bingbot"===be(e.attributes.name)))return!0;if(t.headMetaHttpEquiv&&void 0!==e.attributes["http-equiv"])return!0;if(t.headMetaAuthorship&&("author"===be(e.attributes.name)||"generator"===be(e.attributes.name)||"framework"===be(e.attributes.name)||"publisher"===be(e.attributes.name)||"progid"===be(e.attributes.name)||be(e.attributes.property).match(/^article:/)||be(e.attributes.property).match(/^product:/)))return!0;if(t.headMetaVerification&&("google-site-verification"===be(e.attributes.name)||"yandex-verification"===be(e.attributes.name)||"csrf-token"===be(e.attributes.name)||"p:domain_verify"===be(e.attributes.name)||"verify-v1"===be(e.attributes.name)||"verification"===be(e.attributes.name)||"shopify-checkout-api-token"===be(e.attributes.name)))return!0}}return!1}(j,g)&&(F||j.type!==R.Text||j.isStyle||j.textContent.replace(/^\s+|\s+$/gm,"").length)?re():-2;var U=Object.assign(j,{id:n});if(i.add(e,U),-2===n)return null;C&&C(e);var q=!u;if(U.type===R.Element){q=q&&!U.needBlock,delete U.needBlock;var B=e.shadowRoot;B&&V(B)&&(U.isShadowHost=!0)}if((U.type===R.Document||U.type===R.Element)&&q){g.headWhitespace&&U.type===R.Element&&"head"===U.tagName&&(F=!1);for(var W={doc:r,mirror:i,blockClass:o,blockSelector:s,maskTextClass:a,maskTextSelector:c,skipChild:u,inlineStylesheet:p,maskInputOptions:f,maskTextFn:v,maskInputFn:m,slimDOMOptions:g,dataURLOptions:b,inlineImages:S,recordCanvas:k,preserveWhiteSpace:F,onSerialize:C,onIframeLoad:M,iframeLoadTimeout:E,onStylesheetLoad:O,stylesheetLoadTimeout:_,keepIframeSrcFn:N},z=0,K=Array.from(e.childNodes);z<K.length;z++)($=we(K[z],W))&&U.childNodes.push($);if(function(e){return e.nodeType===e.ELEMENT_NODE}(e)&&e.shadowRoot)for(var H=0,Z=Array.from(e.shadowRoot.childNodes);H<Z.length;H++){var $;($=we(Z[H],W))&&(V(e.shadowRoot)&&($.isShadow=!0),U.childNodes.push($))}}return e.parentNode&&G(e.parentNode)&&V(e.parentNode)&&(U.isShadow=!0),U.type===R.Element&&"iframe"===U.tagName&&function(e,t,n){var r=e.contentWindow;if(r){var i,o=!1;try{i=r.document.readyState}catch(e){return}if("complete"===i){var s="about:blank";if(r.location.href!==s||e.src===s||""===e.src)return setTimeout(t,0),e.addEventListener("load",t);e.addEventListener("load",t)}else{var a=setTimeout((function(){o||(t(),o=!0)}),n);e.addEventListener("load",(function(){clearTimeout(a),o=!0,t()}))}}}(e,(function(){var t=e.contentDocument;if(t&&M){var n=we(t,{doc:t,mirror:i,blockClass:o,blockSelector:s,maskTextClass:a,maskTextSelector:c,skipChild:!1,inlineStylesheet:p,maskInputOptions:f,maskTextFn:v,maskInputFn:m,slimDOMOptions:g,dataURLOptions:b,inlineImages:S,recordCanvas:k,preserveWhiteSpace:F,onSerialize:C,onIframeLoad:M,iframeLoadTimeout:E,onStylesheetLoad:O,stylesheetLoadTimeout:_,keepIframeSrcFn:N});n&&M(e,n)}}),E),U.type===R.Element&&"link"===U.tagName&&"stylesheet"===U.attributes.rel&&function(e,t,n){var r,i=!1;try{r=e.sheet}catch(e){return}if(!r){var o=setTimeout((function(){i||(t(),i=!0)}),n);e.addEventListener("load",(function(){clearTimeout(o),i=!0,t()}))}}(e,(function(){if(O){var t=we(e,{doc:r,mirror:i,blockClass:o,blockSelector:s,maskTextClass:a,maskTextSelector:c,skipChild:!1,inlineStylesheet:p,maskInputOptions:f,maskTextFn:v,maskInputFn:m,slimDOMOptions:g,dataURLOptions:b,inlineImages:S,recordCanvas:k,preserveWhiteSpace:F,onSerialize:C,onIframeLoad:M,iframeLoadTimeout:E,onStylesheetLoad:O,stylesheetLoadTimeout:_,keepIframeSrcFn:N});t&&O(e,t)}}),_),U}var Se=(e=>(e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin",e))(Se||{}),Ie=(e=>(e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration",e[e.Selection=14]="Selection",e[e.AdoptedStyleSheet=15]="AdoptedStyleSheet",e))(Ie||{}),ke=(e=>(e[e.MouseUp=0]="MouseUp",e[e.MouseDown=1]="MouseDown",e[e.Click=2]="Click",e[e.ContextMenu=3]="ContextMenu",e[e.DblClick=4]="DblClick",e[e.Focus=5]="Focus",e[e.Blur=6]="Blur",e[e.TouchStart=7]="TouchStart",e[e.TouchMove_Departed=8]="TouchMove_Departed",e[e.TouchEnd=9]="TouchEnd",e[e.TouchCancel=10]="TouchCancel",e))(ke||{}),Ce=(e=>(e[e.Mouse=0]="Mouse",e[e.Pen=1]="Pen",e[e.Touch=2]="Touch",e))(Ce||{}),Me=(e=>(e[e["2D"]=0]="2D",e[e.WebGL=1]="WebGL",e[e.WebGL2=2]="WebGL2",e))(Me||{});function xe(e,t,n=document){const r={capture:!0,passive:!0};return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t,r)}const Ee="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.";let Oe={map:{},getId:()=>(console.error(Ee),-1),getNode:()=>(console.error(Ee),null),removeNodeFromMap(){console.error(Ee)},has:()=>(console.error(Ee),!1),reset(){console.error(Ee)}};function Te(e,t,n={}){let r=null,i=0;return function(...o){const s=Date.now();i||!1!==n.leading||(i=s);const a=t-(s-i),c=this;a<=0||a>t?(r&&(clearTimeout(r),r=null),i=s,e.apply(c,o)):r||!1===n.trailing||(r=setTimeout((()=>{i=!1===n.leading?0:Date.now(),r=null,e.apply(c,o)}),a))}}function Re(e,t,n,r,i=window){const o=i.Object.getOwnPropertyDescriptor(e,t);return i.Object.defineProperty(e,t,r?n:{set(e){setTimeout((()=>{n.set.call(this,e)}),0),o&&o.set&&o.set.call(this,e)}}),()=>Re(e,t,o||{},!0)}function _e(e,t,n){try{if(!(t in e))return()=>{};const r=e[t],i=n(r);return"function"==typeof i&&(i.prototype=i.prototype||{},Object.defineProperties(i,{__rrweb_original__:{enumerable:!1,value:r}})),e[t]=i,()=>{e[t]=r}}catch(e){return()=>{}}}"undefined"!=typeof window&&window.Proxy&&window.Reflect&&(Oe=new Proxy(Oe,{get:(e,t,n)=>("map"===t&&console.error(Ee),Reflect.get(e,t,n))}));let De,Ne=Date.now;function Le(e){var t,n,r,i,o,s;const a=e.document;return{left:a.scrollingElement?a.scrollingElement.scrollLeft:void 0!==e.pageXOffset?e.pageXOffset:(null==a?void 0:a.documentElement.scrollLeft)||(null===(n=null===(t=null==a?void 0:a.body)||void 0===t?void 0:t.parentElement)||void 0===n?void 0:n.scrollLeft)||(null===(r=null==a?void 0:a.body)||void 0===r?void 0:r.scrollLeft)||0,top:a.scrollingElement?a.scrollingElement.scrollTop:void 0!==e.pageYOffset?e.pageYOffset:(null==a?void 0:a.documentElement.scrollTop)||(null===(o=null===(i=null==a?void 0:a.body)||void 0===i?void 0:i.parentElement)||void 0===o?void 0:o.scrollTop)||(null===(s=null==a?void 0:a.body)||void 0===s?void 0:s.scrollTop)||0}}function Pe(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function Ae(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function Fe(e){return e?e.nodeType===e.ELEMENT_NODE?e:e.parentElement:null}function je(e,t,n,r){if(!e)return!1;const i=Fe(e);if(!i)return!1;try{if("string"==typeof t){if(i.classList.contains(t))return!0;if(r&&null!==i.closest("."+t))return!0}else if(me(i,t,r))return!0}catch(e){}if(n){if(i.matches(n))return!0;if(r&&null!==i.closest(n))return!0}return!1}function Ue(e,t){return-2===t.getId(e)}function qe(e,t){if(G(e))return!1;const n=t.getId(e);return!t.has(n)||(!e.parentNode||e.parentNode.nodeType!==e.DOCUMENT_NODE)&&(!e.parentNode||qe(e.parentNode,t))}function Be(e){return Boolean(e.changedTouches)}function We(e,t){return Boolean("IFRAME"===e.nodeName&&t.getMeta(e))}function ze(e,t){return Boolean("LINK"===e.nodeName&&e.nodeType===e.ELEMENT_NODE&&e.getAttribute&&"stylesheet"===e.getAttribute("rel")&&t.getMeta(e))}function Ge(e){return Boolean(null==e?void 0:e.shadowRoot)}/[1-9][0-9]{12}/.test(Date.now().toString())||(Ne=()=>(new Date).getTime());class Ve{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(e){var t;return null!==(t=this.styleIDMap.get(e))&&void 0!==t?t:-1}has(e){return this.styleIDMap.has(e)}add(e,t){if(this.has(e))return this.getId(e);let n;return n=void 0===t?this.id++:t,this.styleIDMap.set(e,n),this.idStyleMap.set(n,e),n}getStyle(e){return this.idStyleMap.get(e)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}function Ke(e){var t,n;let r=null;return(null===(n=null===(t=e.getRootNode)||void 0===t?void 0:t.call(e))||void 0===n?void 0:n.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&e.getRootNode().host&&(r=e.getRootNode().host),r}function He(e){const t=e.ownerDocument;return!!t&&(t.contains(e)||function(e){const t=e.ownerDocument;if(!t)return!1;const n=function(e){let t,n=e;for(;t=Ke(n);)n=t;return n}(e);return t.contains(n)}(e))}const Ze=e=>De?(...t)=>{try{return e(...t)}catch(e){if(De&&!0===De(e))return;throw e}}:e;function $e(e){return(...t)=>{try{return e(...t)}catch(e){try{e._external_=!0}catch(e){}throw e}}}class Je{constructor(e){this.generateIdFn=e,this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap}getId(e,t,n,r){const i=n||this.getIdToRemoteIdMap(e),o=r||this.getRemoteIdToIdMap(e);let s=i.get(t);return s||(s=this.generateIdFn(),i.set(t,s),o.set(s,t)),s}getIds(e,t){const n=this.getIdToRemoteIdMap(e),r=this.getRemoteIdToIdMap(e);return t.map((t=>this.getId(e,t,n,r)))}getRemoteId(e,t,n){const r=n||this.getRemoteIdToIdMap(e);return"number"!=typeof t?t:r.get(t)||-1}getRemoteIds(e,t){const n=this.getRemoteIdToIdMap(e);return t.map((t=>this.getRemoteId(e,t,n)))}reset(e){if(!e)return this.iframeIdToRemoteIdMap=new WeakMap,void(this.iframeRemoteIdToIdMap=new WeakMap);this.iframeIdToRemoteIdMap.delete(e),this.iframeRemoteIdToIdMap.delete(e)}getIdToRemoteIdMap(e){let t=this.iframeIdToRemoteIdMap.get(e);return t||(t=new Map,this.iframeIdToRemoteIdMap.set(e,t)),t}getRemoteIdToIdMap(e){let t=this.iframeRemoteIdToIdMap.get(e);return t||(t=new Map,this.iframeRemoteIdToIdMap.set(e,t)),t}}class Xe{constructor(e){this.iframes=new WeakMap,this.crossOriginIframeMap=new WeakMap,this.crossOriginIframeMirror=new Je(re),this.crossOriginIframeRootIdMap=new WeakMap,this.mutationCb=e.mutationCb,this.wrappedEmit=e.wrappedEmit,this.stylesheetManager=e.stylesheetManager,this.recordCrossOriginIframes=e.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new Je(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=e.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(e){this.iframes.set(e,!0),e.contentWindow&&this.crossOriginIframeMap.set(e.contentWindow,e)}addLoadListener(e){this.loadListener=e}attachIframe(e,t){var n;this.mutationCb({adds:[{parentId:this.mirror.getId(e),nextId:null,node:t}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),null===(n=this.loadListener)||void 0===n||n.call(this,e),e.contentDocument&&e.contentDocument.adoptedStyleSheets&&e.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(e.contentDocument.adoptedStyleSheets,this.mirror.getId(e.contentDocument))}handleMessage(e){const t=e;if("rrweb"!==t.data.type||t.origin!==t.data.origin)return;if(!e.source)return;const n=this.crossOriginIframeMap.get(e.source);if(!n)return;const r=this.transformCrossOriginEvent(n,t.data.event);r&&this.wrappedEmit(r,t.data.isCheckout)}transformCrossOriginEvent(e,t){var n;switch(t.type){case Se.FullSnapshot:{this.crossOriginIframeMirror.reset(e),this.crossOriginIframeStyleMirror.reset(e),this.replaceIdOnNode(t.data.node,e);const n=t.data.node.id;return this.crossOriginIframeRootIdMap.set(e,n),this.patchRootIdOnNode(t.data.node,n),{timestamp:t.timestamp,type:Se.IncrementalSnapshot,data:{source:Ie.Mutation,adds:[{parentId:this.mirror.getId(e),nextId:null,node:t.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}}}case Se.Meta:case Se.Load:case Se.DomContentLoaded:return!1;case Se.Plugin:return t;case Se.Custom:return this.replaceIds(t.data.payload,e,["id","parentId","previousId","nextId"]),t;case Se.IncrementalSnapshot:switch(t.data.source){case Ie.Mutation:return t.data.adds.forEach((t=>{this.replaceIds(t,e,["parentId","nextId","previousId"]),this.replaceIdOnNode(t.node,e);const n=this.crossOriginIframeRootIdMap.get(e);n&&this.patchRootIdOnNode(t.node,n)})),t.data.removes.forEach((t=>{this.replaceIds(t,e,["parentId","id"])})),t.data.attributes.forEach((t=>{this.replaceIds(t,e,["id"])})),t.data.texts.forEach((t=>{this.replaceIds(t,e,["id"])})),t;case Ie.Drag:case Ie.TouchMove:case Ie.MouseMove:return t.data.positions.forEach((t=>{this.replaceIds(t,e,["id"])})),t;case Ie.ViewportResize:return!1;case Ie.MediaInteraction:case Ie.MouseInteraction:case Ie.Scroll:case Ie.CanvasMutation:case Ie.Input:return this.replaceIds(t.data,e,["id"]),t;case Ie.StyleSheetRule:case Ie.StyleDeclaration:return this.replaceIds(t.data,e,["id"]),this.replaceStyleIds(t.data,e,["styleId"]),t;case Ie.Font:return t;case Ie.Selection:return t.data.ranges.forEach((t=>{this.replaceIds(t,e,["start","end"])})),t;case Ie.AdoptedStyleSheet:return this.replaceIds(t.data,e,["id"]),this.replaceStyleIds(t.data,e,["styleIds"]),null===(n=t.data.styles)||void 0===n||n.forEach((t=>{this.replaceStyleIds(t,e,["styleId"])})),t}}}replace(e,t,n,r){for(const i of r)(Array.isArray(t[i])||"number"==typeof t[i])&&(Array.isArray(t[i])?t[i]=e.getIds(n,t[i]):t[i]=e.getId(n,t[i]));return t}replaceIds(e,t,n){return this.replace(this.crossOriginIframeMirror,e,t,n)}replaceStyleIds(e,t,n){return this.replace(this.crossOriginIframeStyleMirror,e,t,n)}replaceIdOnNode(e,t){this.replaceIds(e,t,["id","rootId"]),"childNodes"in e&&e.childNodes.forEach((e=>{this.replaceIdOnNode(e,t)}))}patchRootIdOnNode(e,t){e.type===R.Document||e.rootId||(e.rootId=t),"childNodes"in e&&e.childNodes.forEach((e=>{this.patchRootIdOnNode(e,t)}))}}function Qe(e){return"__ln"in e}class Ye{constructor(){this.length=0,this.head=null,this.tail=null}get(e){if(e>=this.length)throw new Error("Position outside of list range");let t=this.head;for(let n=0;n<e;n++)t=(null==t?void 0:t.next)||null;return t}addNode(e){const t={value:e,previous:null,next:null};if(e.__ln=t,e.previousSibling&&Qe(e.previousSibling)){const n=e.previousSibling.__ln.next;t.next=n,t.previous=e.previousSibling.__ln,e.previousSibling.__ln.next=t,n&&(n.previous=t)}else if(e.nextSibling&&Qe(e.nextSibling)&&e.nextSibling.__ln.previous){const n=e.nextSibling.__ln.previous;t.previous=n,t.next=e.nextSibling.__ln,e.nextSibling.__ln.previous=t,n&&(n.next=t)}else this.head&&(this.head.previous=t),t.next=this.head,this.head=t;null===t.next&&(this.tail=t),this.length++}removeNode(e){const t=e.__ln;this.head&&(t.previous?(t.previous.next=t.next,t.next?t.next.previous=t.previous:this.tail=t.previous):(this.head=t.next,this.head?this.head.previous=null:this.tail=null),e.__ln&&delete e.__ln,this.length--)}}const et=(e,t)=>`${e}@${t}`;class tt{constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=e=>{e.forEach(this.processMutation),this.emit()},this.emit=()=>{if(this.frozen||this.locked)return;const e=[],t=new Set,n=new Ye,r=e=>{let t=e,n=-2;for(;-2===n;)t=t&&t.nextSibling,n=t&&this.mirror.getId(t);return n},i=i=>{if(!i.parentNode||!He(i))return;const o=G(i.parentNode)?this.mirror.getId(Ke(i)):this.mirror.getId(i.parentNode),s=r(i);if(-1===o||-1===s)return n.addNode(i);const a=we(i,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskTextClass:this.maskTextClass,maskTextSelector:this.maskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:e=>{We(e,this.mirror)&&this.iframeManager.addIframe(e),ze(e,this.mirror)&&this.stylesheetManager.trackLinkElement(e),Ge(i)&&this.shadowDomManager.addShadowRoot(i.shadowRoot,this.doc)},onIframeLoad:(e,t)=>{this.iframeManager.attachIframe(e,t),this.shadowDomManager.observeAttachShadow(e)},onStylesheetLoad:(e,t)=>{this.stylesheetManager.attachLinkElement(e,t)}});a&&(e.push({parentId:o,nextId:s,node:a}),t.add(a.id))};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(const e of this.movedSet)rt(this.removes,e,this.mirror)&&!this.movedSet.has(e.parentNode)||i(e);for(const e of this.addedSet)ot(this.droppedSet,e)||rt(this.removes,e,this.mirror)?ot(this.movedSet,e)?i(e):this.droppedSet.add(e):i(e);let o=null;for(;n.length;){let e=null;if(o){const t=this.mirror.getId(o.value.parentNode),n=r(o.value);-1!==t&&-1!==n&&(e=o)}if(!e){let t=n.tail;for(;t;){const n=t;if(t=t.previous,n){const t=this.mirror.getId(n.value.parentNode);if(-1===r(n.value))continue;if(-1!==t){e=n;break}{const t=n.value;if(t.parentNode&&t.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const r=t.parentNode.host;if(-1!==this.mirror.getId(r)){e=n;break}}}}}}if(!e){for(;n.head;)n.removeNode(n.head.value);break}o=e.previous,n.removeNode(e.value),i(e.value)}const s={texts:this.texts.map((e=>({id:this.mirror.getId(e.node),value:e.value}))).filter((e=>!t.has(e.id))).filter((e=>this.mirror.has(e.id))),attributes:this.attributes.map((e=>{const{attributes:t}=e;if("string"==typeof t.style){const n=JSON.stringify(e.styleDiff),r=JSON.stringify(e._unchangedStyles);n.length<t.style.length&&(n+r).split("var(").length===t.style.split("var(").length&&(t.style=e.styleDiff)}return{id:this.mirror.getId(e.node),attributes:t}})).filter((e=>!t.has(e.id))).filter((e=>this.mirror.has(e.id))),removes:this.removes,adds:e};(s.texts.length||s.attributes.length||s.removes.length||s.adds.length)&&(this.texts=[],this.attributes=[],this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(s))},this.processMutation=e=>{if(!Ue(e.target,this.mirror))switch(e.type){case"characterData":{const t=e.target.textContent;je(e.target,this.blockClass,this.blockSelector,!1)||t===e.oldValue||this.texts.push({value:ge(e.target,this.maskTextClass,this.maskTextSelector)&&t?this.maskTextFn?this.maskTextFn(t,Fe(e.target)):t.replace(/[\S]/g,"*"):t,node:e.target});break}case"attributes":{const t=e.target;let n=e.attributeName,r=e.target.getAttribute(n);if("value"===n){const e=Q(t);r=$({element:t,maskInputOptions:this.maskInputOptions,tagName:t.tagName,type:e,value:r,maskInputFn:this.maskInputFn})}if(je(e.target,this.blockClass,this.blockSelector,!1)||r===e.oldValue)return;let i=this.attributes.find((t=>t.node===e.target));if("IFRAME"===t.tagName&&"src"===n&&!this.keepIframeSrcFn(r)){if(t.contentDocument)return;n="rr_src"}if(i||(i={node:e.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(i)),"type"===n&&"INPUT"===t.tagName&&"password"===(e.oldValue||"").toLowerCase()&&t.setAttribute("data-rr-is-password","true"),!ve(t.tagName,n)&&(i.attributes[n]=fe(this.doc,J(t.tagName),J(n),r),"style"===n)){let n;try{n=document.implementation.createHTMLDocument()}catch(e){n=this.doc}const r=n.createElement("span");e.oldValue&&r.setAttribute("style",e.oldValue);for(const e of Array.from(t.style)){const n=t.style.getPropertyValue(e),o=t.style.getPropertyPriority(e);n!==r.style.getPropertyValue(e)||o!==r.style.getPropertyPriority(e)?i.styleDiff[e]=""===o?n:[n,o]:i._unchangedStyles[e]=[n,o]}for(const e of Array.from(r.style))""===t.style.getPropertyValue(e)&&(i.styleDiff[e]=!1)}break}case"childList":if(je(e.target,this.blockClass,this.blockSelector,!0))return;e.addedNodes.forEach((t=>this.genAdds(t,e.target))),e.removedNodes.forEach((t=>{const n=this.mirror.getId(t),r=G(e.target)?this.mirror.getId(e.target.host):this.mirror.getId(e.target);je(e.target,this.blockClass,this.blockSelector,!1)||Ue(t,this.mirror)||!function(e,t){return-1!==t.getId(e)}(t,this.mirror)||(this.addedSet.has(t)?(nt(this.addedSet,t),this.droppedSet.add(t)):this.addedSet.has(e.target)&&-1===n||qe(e.target,this.mirror)||(this.movedSet.has(t)&&this.movedMap[et(n,r)]?nt(this.movedSet,t):this.removes.push({parentId:r,id:n,isShadow:!(!G(e.target)||!V(e.target))||void 0})),this.mapRemoves.push(t))}))}},this.genAdds=(e,t)=>{if(!this.processedNodeManager.inOtherBuffer(e,this)&&!this.addedSet.has(e)&&!this.movedSet.has(e)){if(this.mirror.hasNode(e)){if(Ue(e,this.mirror))return;this.movedSet.add(e);let n=null;t&&this.mirror.hasNode(t)&&(n=this.mirror.getId(t)),n&&-1!==n&&(this.movedMap[et(this.mirror.getId(e),n)]=!0)}else this.addedSet.add(e),this.droppedSet.delete(e);je(e,this.blockClass,this.blockSelector,!1)||(e.childNodes.forEach((e=>this.genAdds(e))),Ge(e)&&e.shadowRoot.childNodes.forEach((t=>{this.processedNodeManager.add(t,this),this.genAdds(t,e)})))}}}init(e){["mutationCb","blockClass","blockSelector","maskTextClass","maskTextSelector","inlineStylesheet","maskInputOptions","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach((t=>{this[t]=e[t]}))}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function nt(e,t){e.delete(t),t.childNodes.forEach((t=>nt(e,t)))}function rt(e,t,n){return 0!==e.length&&it(e,t,n)}function it(e,t,n){const{parentNode:r}=t;if(!r)return!1;const i=n.getId(r);return!!e.some((e=>e.id===i))||it(e,r,n)}function ot(e,t){return 0!==e.size&&st(e,t)}function st(e,t){const{parentNode:n}=t;return!!n&&(!!e.has(n)||st(e,n))}const at=[];function ct(e){try{if("composedPath"in e){const t=e.composedPath();if(t.length)return t[0]}else if("path"in e&&e.path.length)return e.path[0]}catch(e){}return e&&e.target}function lt(e,t){var n,r;const i=new tt;at.push(i),i.init(e);let o=window.MutationObserver||window.__rrMutationObserver;const s=null===(r=null===(n=null===window||void 0===window?void 0:window.Zone)||void 0===n?void 0:n.__symbol__)||void 0===r?void 0:r.call(n,"MutationObserver");s&&window[s]&&(o=window[s]);const a=new o(Ze(i.processMutations.bind(i)));return a.observe(t,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),a}function ut({scrollCb:e,doc:t,mirror:n,blockClass:r,blockSelector:i,sampling:o}){return xe("scroll",Ze(Te(Ze((o=>{const s=ct(o);if(!s||je(s,r,i,!0))return;const a=n.getId(s);if(s===t&&t.defaultView){const n=Le(t.defaultView);e({id:a,x:n.left,y:n.top})}else e({id:a,x:s.scrollLeft,y:s.scrollTop})})),o.scroll||100)),t)}function dt(e,t){const n=Object.assign({},e);return t||delete n.userTriggered,n}const pt=["INPUT","TEXTAREA","SELECT"],ht=new WeakMap;function ft(e){return function(e,t){if(yt("CSSGroupingRule")&&e.parentRule instanceof CSSGroupingRule||yt("CSSMediaRule")&&e.parentRule instanceof CSSMediaRule||yt("CSSSupportsRule")&&e.parentRule instanceof CSSSupportsRule||yt("CSSConditionRule")&&e.parentRule instanceof CSSConditionRule){const n=Array.from(e.parentRule.cssRules).indexOf(e);t.unshift(n)}else if(e.parentStyleSheet){const n=Array.from(e.parentStyleSheet.cssRules).indexOf(e);t.unshift(n)}return t}(e,[])}function vt(e,t,n){let r,i;return e?(e.ownerNode?r=t.getId(e.ownerNode):i=n.getId(e),{styleId:i,id:r}):{}}function mt({mirror:e,stylesheetManager:t},n){var r,i,o;let s=null;s="#document"===n.nodeName?e.getId(n):e.getId(n.host);const a="#document"===n.nodeName?null===(r=n.defaultView)||void 0===r?void 0:r.Document:null===(o=null===(i=n.ownerDocument)||void 0===i?void 0:i.defaultView)||void 0===o?void 0:o.ShadowRoot,c=(null==a?void 0:a.prototype)?Object.getOwnPropertyDescriptor(null==a?void 0:a.prototype,"adoptedStyleSheets"):void 0;return null!==s&&-1!==s&&a&&c?(Object.defineProperty(n,"adoptedStyleSheets",{configurable:c.configurable,enumerable:c.enumerable,get(){var e;return null===(e=c.get)||void 0===e?void 0:e.call(this)},set(e){var n;const r=null===(n=c.set)||void 0===n?void 0:n.call(this,e);if(null!==s&&-1!==s)try{t.adoptStyleSheets(e,s)}catch(e){}return r}}),Ze((()=>{Object.defineProperty(n,"adoptedStyleSheets",{configurable:c.configurable,enumerable:c.enumerable,get:c.get,set:c.set})}))):()=>{}}function gt(e,t={}){const n=e.doc.defaultView;if(!n)return()=>{};let r;!function(e,t){const{mutationCb:n,mousemoveCb:r,mouseInteractionCb:i,scrollCb:o,viewportResizeCb:s,inputCb:a,mediaInteractionCb:c,styleSheetRuleCb:l,styleDeclarationCb:u,canvasMutationCb:d,fontCb:p,selectionCb:h}=e;e.mutationCb=(...e)=>{t.mutation&&t.mutation(...e),n(...e)},e.mousemoveCb=(...e)=>{t.mousemove&&t.mousemove(...e),r(...e)},e.mouseInteractionCb=(...e)=>{t.mouseInteraction&&t.mouseInteraction(...e),i(...e)},e.scrollCb=(...e)=>{t.scroll&&t.scroll(...e),o(...e)},e.viewportResizeCb=(...e)=>{t.viewportResize&&t.viewportResize(...e),s(...e)},e.inputCb=(...e)=>{t.input&&t.input(...e),a(...e)},e.mediaInteractionCb=(...e)=>{t.mediaInteaction&&t.mediaInteaction(...e),c(...e)},e.styleSheetRuleCb=(...e)=>{t.styleSheetRule&&t.styleSheetRule(...e),l(...e)},e.styleDeclarationCb=(...e)=>{t.styleDeclaration&&t.styleDeclaration(...e),u(...e)},e.canvasMutationCb=(...e)=>{t.canvasMutation&&t.canvasMutation(...e),d(...e)},e.fontCb=(...e)=>{t.font&&t.font(...e),p(...e)},e.selectionCb=(...e)=>{t.selection&&t.selection(...e),h(...e)}}(e,t),e.recordDOM&&(r=lt(e,e.doc));const i=function({mousemoveCb:e,sampling:t,doc:n,mirror:r}){if(!1===t.mousemove)return()=>{};const i="number"==typeof t.mousemove?t.mousemove:50,o="number"==typeof t.mousemoveCallback?t.mousemoveCallback:500;let s,a=[];const c=Te(Ze((t=>{const n=Date.now()-s;e(a.map((e=>(e.timeOffset-=n,e))),t),a=[],s=null})),o),l=Ze(Te(Ze((e=>{const t=ct(e),{clientX:n,clientY:i}=Be(e)?e.changedTouches[0]:e;s||(s=Ne()),a.push({x:n,y:i,id:r.getId(t),timeOffset:Ne()-s}),c("undefined"!=typeof DragEvent&&e instanceof DragEvent?Ie.Drag:e instanceof MouseEvent?Ie.MouseMove:Ie.TouchMove)})),i,{trailing:!1})),u=[xe("mousemove",l,n),xe("touchmove",l,n),xe("drag",l,n)];return Ze((()=>{u.forEach((e=>e()))}))}(e),o=function({mouseInteractionCb:e,doc:t,mirror:n,blockClass:r,blockSelector:i,sampling:o}){if(!1===o.mouseInteraction)return()=>{};const s=!0===o.mouseInteraction||void 0===o.mouseInteraction?{}:o.mouseInteraction,a=[];let c=null;return Object.keys(ke).filter((e=>Number.isNaN(Number(e))&&!e.endsWith("_Departed")&&!1!==s[e])).forEach((o=>{let s=J(o);const l=(t=>o=>{const s=ct(o);if(je(s,r,i,!0))return;let a=null,l=t;if("pointerType"in o){switch(o.pointerType){case"mouse":a=Ce.Mouse;break;case"touch":a=Ce.Touch;break;case"pen":a=Ce.Pen}a===Ce.Touch?ke[t]===ke.MouseDown?l="TouchStart":ke[t]===ke.MouseUp&&(l="TouchEnd"):Ce.Pen}else Be(o)&&(a=Ce.Touch);null!==a?(c=a,(l.startsWith("Touch")&&a===Ce.Touch||l.startsWith("Mouse")&&a===Ce.Mouse)&&(a=null)):ke[t]===ke.Click&&(a=c,c=null);const u=Be(o)?o.changedTouches[0]:o;if(!u)return;const d=n.getId(s),{clientX:p,clientY:h}=u;Ze(e)(Object.assign({type:ke[l],id:d,x:p,y:h},null!==a&&{pointerType:a}))})(o);if(window.PointerEvent)switch(ke[o]){case ke.MouseDown:case ke.MouseUp:s=s.replace("mouse","pointer");break;case ke.TouchStart:case ke.TouchEnd:return}a.push(xe(s,l,t))})),Ze((()=>{a.forEach((e=>e()))}))}(e),s=ut(e),a=function({viewportResizeCb:e},{win:t}){let n=-1,r=-1;return xe("resize",Ze(Te(Ze((()=>{const t=Pe(),i=Ae();n===t&&r===i||(e({width:Number(i),height:Number(t)}),n=t,r=i)})),200)),t)}(e,{win:n}),c=function({inputCb:e,doc:t,mirror:n,blockClass:r,blockSelector:i,ignoreClass:o,ignoreSelector:s,maskInputOptions:a,maskInputFn:c,sampling:l,userTriggeredOnInput:u}){function d(e){let n=ct(e);const l=e.isTrusted,d=n&&n.tagName;if(n&&"OPTION"===d&&(n=n.parentElement),!n||!d||pt.indexOf(d)<0||je(n,r,i,!0))return;if(n.classList.contains(o)||s&&n.matches(s))return;let h=n.value,f=!1;const v=Q(n)||"";"radio"===v||"checkbox"===v?f=n.checked:(a[d.toLowerCase()]||a[v])&&(h=$({element:n,maskInputOptions:a,tagName:d,type:v,value:h,maskInputFn:c})),p(n,Ze(dt)({text:h,isChecked:f,userTriggered:l},u));const m=n.name;"radio"===v&&m&&f&&t.querySelectorAll(`input[type="radio"][name="${m}"]`).forEach((e=>{e!==n&&p(e,Ze(dt)({text:e.value,isChecked:!f,userTriggered:!1},u))}))}function p(t,r){const i=ht.get(t);if(!i||i.text!==r.text||i.isChecked!==r.isChecked){ht.set(t,r);const i=n.getId(t);Ze(e)(Object.assign(Object.assign({},r),{id:i}))}}const h=("last"===l.input?["change"]:["input","change"]).map((e=>xe(e,Ze(d),t))),f=t.defaultView;if(!f)return()=>{h.forEach((e=>e()))};const v=f.Object.getOwnPropertyDescriptor(f.HTMLInputElement.prototype,"value"),m=[[f.HTMLInputElement.prototype,"value"],[f.HTMLInputElement.prototype,"checked"],[f.HTMLSelectElement.prototype,"value"],[f.HTMLTextAreaElement.prototype,"value"],[f.HTMLSelectElement.prototype,"selectedIndex"],[f.HTMLOptionElement.prototype,"selected"]];return v&&v.set&&h.push(...m.map((e=>Re(e[0],e[1],{set(){Ze(d)({target:this,isTrusted:!1})}},!1,f)))),Ze((()=>{h.forEach((e=>e()))}))}(e),l=function({mediaInteractionCb:e,blockClass:t,blockSelector:n,mirror:r,sampling:i,doc:o}){const s=Ze((o=>Te(Ze((i=>{const s=ct(i);if(!s||je(s,t,n,!0))return;const{currentTime:a,volume:c,muted:l,playbackRate:u}=s;e({type:o,id:r.getId(s),currentTime:a,volume:c,muted:l,playbackRate:u})})),i.media||500))),a=[xe("play",s(0),o),xe("pause",s(1),o),xe("seeked",s(2),o),xe("volumechange",s(3),o),xe("ratechange",s(4),o)];return Ze((()=>{a.forEach((e=>e()))}))}(e);let u=()=>{},d=()=>{},p=()=>{},h=()=>{};e.recordDOM&&(u=function({styleSheetRuleCb:e,mirror:t,stylesheetManager:n},{win:r}){if(!r.CSSStyleSheet||!r.CSSStyleSheet.prototype)return()=>{};const i=r.CSSStyleSheet.prototype.insertRule;r.CSSStyleSheet.prototype.insertRule=new Proxy(i,{apply:Ze(((r,i,o)=>{const[s,a]=o,{id:c,styleId:l}=vt(i,t,n.styleMirror);return(c&&-1!==c||l&&-1!==l)&&e({id:c,styleId:l,adds:[{rule:s,index:a}]}),$e((()=>r.apply(i,o)))()}))});const o=r.CSSStyleSheet.prototype.deleteRule;let s,a;r.CSSStyleSheet.prototype.deleteRule=new Proxy(o,{apply:Ze(((r,i,o)=>{const[s]=o,{id:a,styleId:c}=vt(i,t,n.styleMirror);return(a&&-1!==a||c&&-1!==c)&&e({id:a,styleId:c,removes:[{index:s}]}),$e((()=>r.apply(i,o)))()}))}),r.CSSStyleSheet.prototype.replace&&(s=r.CSSStyleSheet.prototype.replace,r.CSSStyleSheet.prototype.replace=new Proxy(s,{apply:Ze(((r,i,o)=>{const[s]=o,{id:a,styleId:c}=vt(i,t,n.styleMirror);return(a&&-1!==a||c&&-1!==c)&&e({id:a,styleId:c,replace:s}),r.apply(i,o)}))})),r.CSSStyleSheet.prototype.replaceSync&&(a=r.CSSStyleSheet.prototype.replaceSync,r.CSSStyleSheet.prototype.replaceSync=new Proxy(a,{apply:Ze(((r,i,o)=>{const[s]=o,{id:a,styleId:c}=vt(i,t,n.styleMirror);return(a&&-1!==a||c&&-1!==c)&&e({id:a,styleId:c,replaceSync:s}),r.apply(i,o)}))}));const c={};bt("CSSGroupingRule")?c.CSSGroupingRule=r.CSSGroupingRule:(bt("CSSMediaRule")&&(c.CSSMediaRule=r.CSSMediaRule),bt("CSSConditionRule")&&(c.CSSConditionRule=r.CSSConditionRule),bt("CSSSupportsRule")&&(c.CSSSupportsRule=r.CSSSupportsRule));const l={};return Object.entries(c).forEach((([r,i])=>{l[r]={insertRule:i.prototype.insertRule,deleteRule:i.prototype.deleteRule},i.prototype.insertRule=new Proxy(l[r].insertRule,{apply:Ze(((r,i,o)=>{const[s,a]=o,{id:c,styleId:l}=vt(i.parentStyleSheet,t,n.styleMirror);return(c&&-1!==c||l&&-1!==l)&&e({id:c,styleId:l,adds:[{rule:s,index:[...ft(i),a||0]}]}),r.apply(i,o)}))}),i.prototype.deleteRule=new Proxy(l[r].deleteRule,{apply:Ze(((r,i,o)=>{const[s]=o,{id:a,styleId:c}=vt(i.parentStyleSheet,t,n.styleMirror);return(a&&-1!==a||c&&-1!==c)&&e({id:a,styleId:c,removes:[{index:[...ft(i),s]}]}),r.apply(i,o)}))})})),Ze((()=>{r.CSSStyleSheet.prototype.insertRule=i,r.CSSStyleSheet.prototype.deleteRule=o,s&&(r.CSSStyleSheet.prototype.replace=s),a&&(r.CSSStyleSheet.prototype.replaceSync=a),Object.entries(c).forEach((([e,t])=>{t.prototype.insertRule=l[e].insertRule,t.prototype.deleteRule=l[e].deleteRule}))}))}(e,{win:n}),d=mt(e,e.doc),p=function({styleDeclarationCb:e,mirror:t,ignoreCSSAttributes:n,stylesheetManager:r},{win:i}){const o=i.CSSStyleDeclaration.prototype.setProperty;i.CSSStyleDeclaration.prototype.setProperty=new Proxy(o,{apply:Ze(((i,s,a)=>{var c;const[l,u,d]=a;if(n.has(l))return o.apply(s,[l,u,d]);const{id:p,styleId:h}=vt(null===(c=s.parentRule)||void 0===c?void 0:c.parentStyleSheet,t,r.styleMirror);return(p&&-1!==p||h&&-1!==h)&&e({id:p,styleId:h,set:{property:l,value:u,priority:d},index:ft(s.parentRule)}),i.apply(s,a)}))});const s=i.CSSStyleDeclaration.prototype.removeProperty;return i.CSSStyleDeclaration.prototype.removeProperty=new Proxy(s,{apply:Ze(((i,o,a)=>{var c;const[l]=a;if(n.has(l))return s.apply(o,[l]);const{id:u,styleId:d}=vt(null===(c=o.parentRule)||void 0===c?void 0:c.parentStyleSheet,t,r.styleMirror);return(u&&-1!==u||d&&-1!==d)&&e({id:u,styleId:d,remove:{property:l},index:ft(o.parentRule)}),i.apply(o,a)}))}),Ze((()=>{i.CSSStyleDeclaration.prototype.setProperty=o,i.CSSStyleDeclaration.prototype.removeProperty=s}))}(e,{win:n}),e.collectFonts&&(h=function({fontCb:e,doc:t}){const n=t.defaultView;if(!n)return()=>{};const r=[],i=new WeakMap,o=n.FontFace;n.FontFace=function(e,t,n){const r=new o(e,t,n);return i.set(r,{family:e,buffer:"string"!=typeof t,descriptors:n,fontSource:"string"==typeof t?t:JSON.stringify(Array.from(new Uint8Array(t)))}),r};const s=_e(t.fonts,"add",(function(t){return function(n){return setTimeout(Ze((()=>{const t=i.get(n);t&&(e(t),i.delete(n))})),0),t.apply(this,[n])}}));return r.push((()=>{n.FontFace=o})),r.push(s),Ze((()=>{r.forEach((e=>e()))}))}(e)));const f=function(e){const{doc:t,mirror:n,blockClass:r,blockSelector:i,selectionCb:o}=e;let s=!0;const a=Ze((()=>{const e=t.getSelection();if(!e||s&&(null==e?void 0:e.isCollapsed))return;s=e.isCollapsed||!1;const a=[],c=e.rangeCount||0;for(let t=0;t<c;t++){const o=e.getRangeAt(t),{startContainer:s,startOffset:c,endContainer:l,endOffset:u}=o;je(s,r,i,!0)||je(l,r,i,!0)||a.push({start:n.getId(s),startOffset:c,end:n.getId(l),endOffset:u})}o({ranges:a})}));return a(),xe("selectionchange",a)}(e),v=[];for(const t of e.plugins)v.push(t.observer(t.callback,n,t.options));return Ze((()=>{at.forEach((e=>e.reset())),null==r||r.disconnect(),i(),o(),s(),a(),c(),l(),u(),d(),p(),h(),f(),v.forEach((e=>e()))}))}function yt(e){return void 0!==window[e]}function bt(e){return Boolean(void 0!==window[e]&&window[e].prototype&&"insertRule"in window[e].prototype&&"deleteRule"in window[e].prototype)}for(var wt,St,It=(wt=function(){!function(){function e(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="undefined"==typeof Uint8Array?[]:new Uint8Array(256),r=0;r<t.length;r++)n[t.charCodeAt(r)]=r;var i=function(e){var n,r=new Uint8Array(e),i=r.length,o="";for(n=0;n<i;n+=3)o+=t[r[n]>>2],o+=t[(3&r[n])<<4|r[n+1]>>4],o+=t[(15&r[n+1])<<2|r[n+2]>>6],o+=t[63&r[n+2]];return i%3==2?o=o.substring(0,o.length-1)+"=":i%3==1&&(o=o.substring(0,o.length-2)+"=="),o};const o=new Map,s=new Map,a=self;a.onmessage=function(t){return e(this,void 0,void 0,(function*(){if(!("OffscreenCanvas"in globalThis))return a.postMessage({id:t.data.id});{const{id:n,bitmap:r,width:c,height:l,dataURLOptions:u}=t.data,d=function(t,n,r){return e(this,void 0,void 0,(function*(){const e=`${t}-${n}`;if("OffscreenCanvas"in globalThis){if(s.has(e))return s.get(e);const o=new OffscreenCanvas(t,n);o.getContext("2d");const a=yield o.convertToBlob(r),c=yield a.arrayBuffer(),l=i(c);return s.set(e,l),l}return""}))}(c,l,u),p=new OffscreenCanvas(c,l);p.getContext("2d").drawImage(r,0,0),r.close();const h=yield p.convertToBlob(u),f=h.type,v=yield h.arrayBuffer(),m=i(v);if(!o.has(n)&&(yield d)===m)return o.set(n,m),a.postMessage({id:n});if(o.get(n)===m)return a.postMessage({id:n});a.postMessage({id:n,type:f,base64:m,width:c,height:l}),o.set(n,m)}}))}}()},function(e){return St=St||function(e,t){var n=function(e,t){var n=e.toString().split("\n");n.pop(),n.shift();for(var r=n[0].search(/\S/),i=/(['"])__worker_loader_strict__(['"])/g,o=0,s=n.length;o<s;++o)n[o]=n[o].substring(r).replace(i,"$1use strict$2")+"\n";return n}(e),r=new Blob(n,{type:"application/javascript"});return URL.createObjectURL(r)}(wt),new Worker(St,e)}),kt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ct="undefined"==typeof Uint8Array?[]:new Uint8Array(256),Mt=0;Mt<kt.length;Mt++)Ct[kt.charCodeAt(Mt)]=Mt;const xt=new Map,Et=(e,t,n)=>{if(!e||!Rt(e,t)&&"object"!=typeof e)return;const r=function(e,t){let n=xt.get(e);return n||(n=new Map,xt.set(e,n)),n.has(t)||n.set(t,[]),n.get(t)}(n,e.constructor.name);let i=r.indexOf(e);return-1===i&&(i=r.length,r.push(e)),i};function Ot(e,t,n){if(e instanceof Array)return e.map((e=>Ot(e,t,n)));if(null===e)return e;if(e instanceof Float32Array||e instanceof Float64Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Int16Array||e instanceof Int8Array||e instanceof Uint8ClampedArray)return{rr_type:e.constructor.name,args:[Object.values(e)]};if(e instanceof ArrayBuffer){const t=e.constructor.name,n=function(e){var t,n=new Uint8Array(e),r=n.length,i="";for(t=0;t<r;t+=3)i+=kt[n[t]>>2],i+=kt[(3&n[t])<<4|n[t+1]>>4],i+=kt[(15&n[t+1])<<2|n[t+2]>>6],i+=kt[63&n[t+2]];return r%3==2?i=i.substring(0,i.length-1)+"=":r%3==1&&(i=i.substring(0,i.length-2)+"=="),i}(e);return{rr_type:t,base64:n}}if(e instanceof DataView)return{rr_type:e.constructor.name,args:[Ot(e.buffer,t,n),e.byteOffset,e.byteLength]};if(e instanceof HTMLImageElement){const t=e.constructor.name,{src:n}=e;return{rr_type:t,src:n}}return e instanceof HTMLCanvasElement?{rr_type:"HTMLImageElement",src:e.toDataURL()}:e instanceof ImageData?{rr_type:e.constructor.name,args:[Ot(e.data,t,n),e.width,e.height]}:Rt(e,t)||"object"==typeof e?{rr_type:e.constructor.name,index:Et(e,t,n)}:e}const Tt=(e,t,n)=>[...e].map((e=>Ot(e,t,n))),Rt=(e,t)=>{const n=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter((e=>"function"==typeof t[e]));return Boolean(n.find((n=>e instanceof t[n])))};function _t(e,t,n,r){const i=[];try{const o=_e(e.HTMLCanvasElement.prototype,"getContext",(function(e){return function(i,...o){if(!je(this,t,n,!0)){const e=function(e){return"experimental-webgl"===e?"webgl":e}(i);if("__context"in this||(this.__context=e),r&&["webgl","webgl2"].includes(e))if(o[0]&&"object"==typeof o[0]){const e=o[0];e.preserveDrawingBuffer||(e.preserveDrawingBuffer=!0)}else o.splice(0,1,{preserveDrawingBuffer:!0})}return e.apply(this,[i,...o])}}));i.push(o)}catch(e){console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{i.forEach((e=>e()))}}function Dt(e,t,n,r,i,o,s){const a=[],c=Object.getOwnPropertyNames(e);for(const o of c)if(!["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(o))try{if("function"!=typeof e[o])continue;const c=_e(e,o,(function(e){return function(...a){const c=e.apply(this,a);if(Et(c,s,this),"tagName"in this.canvas&&!je(this.canvas,r,i,!0)){const e=Tt([...a],s,this),r={type:t,property:o,args:e};n(this.canvas,r)}return c}}));a.push(c)}catch(r){const i=Re(e,o,{set(e){n(this.canvas,{type:t,property:o,args:[e],setter:!0})}});a.push(i)}return a}class Nt{reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}constructor(e){this.pendingCanvasMutations=new Map,this.rafStamps={latestId:0,invokeId:null},this.frozen=!1,this.locked=!1,this.processMutation=(e,t)=>{!(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId)&&this.rafStamps.invokeId||(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(e)||this.pendingCanvasMutations.set(e,[]),this.pendingCanvasMutations.get(e).push(t)};const{sampling:t="all",win:n,blockClass:r,blockSelector:i,recordCanvas:o,dataURLOptions:s}=e;this.mutationCb=e.mutationCb,this.mirror=e.mirror,o&&"all"===t&&this.initCanvasMutationObserver(n,r,i),o&&"number"==typeof t&&this.initCanvasFPSObserver(t,n,r,i,{dataURLOptions:s})}initCanvasFPSObserver(e,t,n,r,i){const o=_t(t,n,r,!0),s=new Map,a=new It;a.onmessage=e=>{const{id:t}=e.data;if(s.set(t,!1),!("base64"in e.data))return;const{base64:n,type:r,width:i,height:o}=e.data;this.mutationCb({id:t,type:Me["2D"],commands:[{property:"clearRect",args:[0,0,i,o]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:n}],type:r}]},0,0]}]})};const c=1e3/e;let l,u=0;const d=e=>{u&&e-u<c||(u=e,(()=>{const e=[];return t.document.querySelectorAll("canvas").forEach((t=>{je(t,n,r,!0)||e.push(t)})),e})().forEach((e=>function(e,t,n,r){return new(n||(n=Promise))((function(t,i){function o(e){try{a(r.next(e))}catch(e){i(e)}}function s(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var r;e.done?t(e.value):(r=e.value,r instanceof n?r:new n((function(e){e(r)}))).then(o,s)}a((r=r.apply(e,[])).next())}))}(this,0,void 0,(function*(){var t;const n=this.mirror.getId(e);if(s.get(n))return;if(s.set(n,!0),["webgl","webgl2"].includes(e.__context)){const n=e.getContext(e.__context);!1===(null===(t=null==n?void 0:n.getContextAttributes())||void 0===t?void 0:t.preserveDrawingBuffer)&&n.clear(n.COLOR_BUFFER_BIT)}const r=yield createImageBitmap(e);a.postMessage({id:n,bitmap:r,width:e.width,height:e.height,dataURLOptions:i.dataURLOptions},[r])}))))),l=requestAnimationFrame(d)};l=requestAnimationFrame(d),this.resetObservers=()=>{o(),cancelAnimationFrame(l)}}initCanvasMutationObserver(e,t,n){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();const r=_t(e,t,n,!1),i=function(e,t,n,r){const i=[],o=Object.getOwnPropertyNames(t.CanvasRenderingContext2D.prototype);for(const s of o)try{if("function"!=typeof t.CanvasRenderingContext2D.prototype[s])continue;const o=_e(t.CanvasRenderingContext2D.prototype,s,(function(i){return function(...o){return je(this.canvas,n,r,!0)||setTimeout((()=>{const n=Tt([...o],t,this);e(this.canvas,{type:Me["2D"],property:s,args:n})}),0),i.apply(this,o)}}));i.push(o)}catch(n){const r=Re(t.CanvasRenderingContext2D.prototype,s,{set(t){e(this.canvas,{type:Me["2D"],property:s,args:[t],setter:!0})}});i.push(r)}return()=>{i.forEach((e=>e()))}}(this.processMutation.bind(this),e,t,n),o=function(e,t,n,r,i){const o=[];return o.push(...Dt(t.WebGLRenderingContext.prototype,Me.WebGL,e,n,r,0,t)),void 0!==t.WebGL2RenderingContext&&o.push(...Dt(t.WebGL2RenderingContext.prototype,Me.WebGL2,e,n,r,0,t)),()=>{o.forEach((e=>e()))}}(this.processMutation.bind(this),e,t,n,this.mirror);this.resetObservers=()=>{r(),i(),o()}}startPendingCanvasMutationFlusher(){requestAnimationFrame((()=>this.flushPendingCanvasMutations()))}startRAFTimestamping(){const e=t=>{this.rafStamps.latestId=t,requestAnimationFrame(e)};requestAnimationFrame(e)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach(((e,t)=>{const n=this.mirror.getId(t);this.flushPendingCanvasMutationFor(t,n)})),requestAnimationFrame((()=>this.flushPendingCanvasMutations()))}flushPendingCanvasMutationFor(e,t){if(this.frozen||this.locked)return;const n=this.pendingCanvasMutations.get(e);if(!n||-1===t)return;const r=n.map((e=>{const t=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["type"]);return t})),{type:i}=n[0];this.mutationCb({id:t,type:i,commands:r}),this.pendingCanvasMutations.delete(e)}}class Lt{constructor(){this.nodeMap=new WeakMap,this.loop=!0,this.periodicallyClear()}periodicallyClear(){requestAnimationFrame((()=>{this.clear(),this.loop&&this.periodicallyClear()}))}inOtherBuffer(e,t){const n=this.nodeMap.get(e);return n&&Array.from(n).some((e=>e!==t))}add(e,t){this.nodeMap.set(e,(this.nodeMap.get(e)||new Set).add(t))}clear(){this.nodeMap=new WeakMap}destroy(){this.loop=!1}}class Pt{constructor(e){this.shadowDoms=new WeakSet,this.restoreHandlers=[],this.mutationCb=e.mutationCb,this.scrollCb=e.scrollCb,this.bypassOptions=e.bypassOptions,this.mirror=e.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(e,t){if(!V(e))return;if(this.shadowDoms.has(e))return;this.shadowDoms.add(e);const n=lt(Object.assign(Object.assign({},this.bypassOptions),{doc:t,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),e);this.restoreHandlers.push((()=>n.disconnect())),this.restoreHandlers.push(ut(Object.assign(Object.assign({},this.bypassOptions),{scrollCb:this.scrollCb,doc:e,mirror:this.mirror}))),setTimeout((()=>{e.adoptedStyleSheets&&e.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(e.adoptedStyleSheets,this.mirror.getId(e.host)),this.restoreHandlers.push(mt({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},e))}),0)}observeAttachShadow(e){e.contentWindow&&e.contentDocument&&this.patchAttachShadow(e.contentWindow.Element,e.contentDocument)}patchAttachShadow(e,t){const n=this;this.restoreHandlers.push(_e(e.prototype,"attachShadow",(function(e){return function(r){const i=e.call(this,r);return this.shadowRoot&&He(this)&&n.addShadowRoot(this.shadowRoot,t),i}})))}reset(){this.restoreHandlers.forEach((e=>{try{e()}catch(e){}})),this.restoreHandlers=[],this.shadowDoms=new WeakSet}}class At{constructor(e){this.trackedLinkElements=new WeakSet,this.styleMirror=new Ve,this.mutationCb=e.mutationCb,this.adoptedStyleSheetCb=e.adoptedStyleSheetCb}attachLinkElement(e,t){"_cssText"in t.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:t.id,attributes:t.attributes}]}),this.trackLinkElement(e)}trackLinkElement(e){this.trackedLinkElements.has(e)||(this.trackedLinkElements.add(e),this.trackStylesheetInLinkElement(e))}adoptStyleSheets(e,t){if(0===e.length)return;const n={id:t,styleIds:[]},r=[];for(const t of e){let e;this.styleMirror.has(t)?e=this.styleMirror.getId(t):(e=this.styleMirror.add(t),r.push({styleId:e,rules:Array.from(t.rules||CSSRule,((e,t)=>({rule:H(e),index:t})))})),n.styleIds.push(e)}r.length>0&&(n.styles=r),this.adoptedStyleSheetCb(n)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(e){}}function Ft(e){return Object.assign(Object.assign({},e),{timestamp:Ne()})}let jt,Ut,qt,Bt=!1;const Wt=new Z;function zt(e={}){const{emit:t,checkoutEveryNms:n,checkoutEveryNth:r,blockClass:i="rr-block",blockSelector:o=null,ignoreClass:s="rr-ignore",ignoreSelector:a=null,maskTextClass:c="rr-mask",maskTextSelector:l=null,inlineStylesheet:u=!0,maskAllInputs:d,maskInputOptions:p,slimDOMOptions:h,maskInputFn:f,maskTextFn:v,hooks:m,packFn:g,sampling:y={},dataURLOptions:b={},mousemoveWait:w,recordDOM:S=!0,recordCanvas:I=!1,recordCrossOriginIframes:k=!1,recordAfter:C=("DOMContentLoaded"===e.recordAfter?e.recordAfter:"load"),userTriggeredOnInput:M=!1,collectFonts:x=!1,inlineImages:E=!1,plugins:O,keepIframeSrcFn:T=(()=>!1),ignoreCSSAttributes:R=new Set([]),errorHandler:_}=e;!function(e){De=e}(_);const D=!k||window.parent===window;let N=!1;if(!D)try{window.parent.document&&(N=!1)}catch(e){N=!0}if(D&&!t)throw new Error("emit function is required");void 0!==w&&void 0===y.mousemove&&(y.mousemove=w),Wt.reset();const L=!0===d?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:void 0!==p?p:{password:!0},P=!0===h||"all"===h?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:"all"===h,headMetaDescKeywords:"all"===h}:h||{};let A;!function(e=window){"NodeList"in e&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...e)=>{let t=e[0];if(!(0 in e))throw new TypeError("1 argument is required");do{if(this===t)return!0}while(t=t&&t.parentNode);return!1})}();let F=0;const j=e=>{for(const t of O||[])t.eventProcessor&&(e=t.eventProcessor(e));return g&&!N&&(e=g(e)),e};jt=(e,i)=>{var o;if(!(null===(o=at[0])||void 0===o?void 0:o.isFrozen())||e.type===Se.FullSnapshot||e.type===Se.IncrementalSnapshot&&e.data.source===Ie.Mutation||at.forEach((e=>e.unfreeze())),D)null==t||t(j(e),i);else if(N){const t={type:"rrweb",event:j(e),origin:window.location.origin,isCheckout:i};window.parent.postMessage(t,"*")}if(e.type===Se.FullSnapshot)A=e,F=0;else if(e.type===Se.IncrementalSnapshot){if(e.data.source===Ie.Mutation&&e.data.isAttachIframe)return;F++;const t=r&&F>=r,i=n&&e.timestamp-A.timestamp>n;(t||i)&&Ut(!0)}};const U=e=>{jt(Ft({type:Se.IncrementalSnapshot,data:Object.assign({source:Ie.Mutation},e)}))},q=e=>jt(Ft({type:Se.IncrementalSnapshot,data:Object.assign({source:Ie.Scroll},e)})),B=e=>jt(Ft({type:Se.IncrementalSnapshot,data:Object.assign({source:Ie.CanvasMutation},e)})),W=new At({mutationCb:U,adoptedStyleSheetCb:e=>jt(Ft({type:Se.IncrementalSnapshot,data:Object.assign({source:Ie.AdoptedStyleSheet},e)}))}),z=new Xe({mirror:Wt,mutationCb:U,stylesheetManager:W,recordCrossOriginIframes:k,wrappedEmit:jt});for(const e of O||[])e.getMirror&&e.getMirror({nodeMirror:Wt,crossOriginIframeMirror:z.crossOriginIframeMirror,crossOriginIframeStyleMirror:z.crossOriginIframeStyleMirror});const G=new Lt;qt=new Nt({recordCanvas:I,mutationCb:B,win:window,blockClass:i,blockSelector:o,mirror:Wt,sampling:y.canvas,dataURLOptions:b});const V=new Pt({mutationCb:U,scrollCb:q,bypassOptions:{blockClass:i,blockSelector:o,maskTextClass:c,maskTextSelector:l,inlineStylesheet:u,maskInputOptions:L,dataURLOptions:b,maskTextFn:v,maskInputFn:f,recordCanvas:I,inlineImages:E,sampling:y,slimDOMOptions:P,iframeManager:z,stylesheetManager:W,canvasManager:qt,keepIframeSrcFn:T,processedNodeManager:G},mirror:Wt});Ut=(e=!1)=>{if(!S)return;jt(Ft({type:Se.Meta,data:{href:window.location.href,width:Ae(),height:Pe()}}),e),W.reset(),V.init(),at.forEach((e=>e.lock()));const t=function(e,t){var n=t||{},r=n.mirror,i=void 0===r?new Z:r,o=n.blockClass,s=n.blockSelector,a=n.maskTextClass,c=n.maskTextSelector,l=n.inlineStylesheet,u=n.inlineImages,d=n.recordCanvas,p=n.maskAllInputs,h=void 0!==p&&p,f=n.slimDOM,v=void 0!==f&&f,m=n.keepIframeSrcFn;return we(e,{doc:e,mirror:i,blockClass:void 0===o?"rr-block":o,blockSelector:void 0===s?null:s,maskTextClass:void 0===a?"rr-mask":a,maskTextSelector:void 0===c?null:c,skipChild:!1,inlineStylesheet:void 0===l||l,maskInputOptions:!0===h?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:!1===h?{password:!0}:h,maskTextFn:n.maskTextFn,maskInputFn:n.maskInputFn,slimDOMOptions:!0===v||"all"===v?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:"all"===v,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:!1===v?{}:v,dataURLOptions:n.dataURLOptions,inlineImages:void 0!==u&&u,recordCanvas:void 0!==d&&d,preserveWhiteSpace:n.preserveWhiteSpace,onSerialize:n.onSerialize,onIframeLoad:n.onIframeLoad,iframeLoadTimeout:n.iframeLoadTimeout,onStylesheetLoad:n.onStylesheetLoad,stylesheetLoadTimeout:n.stylesheetLoadTimeout,keepIframeSrcFn:void 0===m?function(){return!1}:m,newlyAddedElement:!1})}(document,{mirror:Wt,blockClass:i,blockSelector:o,maskTextClass:c,maskTextSelector:l,inlineStylesheet:u,maskAllInputs:L,maskTextFn:v,maskInputFn:f,slimDOM:P,dataURLOptions:b,recordCanvas:I,inlineImages:E,onSerialize:e=>{We(e,Wt)&&z.addIframe(e),ze(e,Wt)&&W.trackLinkElement(e),Ge(e)&&V.addShadowRoot(e.shadowRoot,document)},onIframeLoad:(e,t)=>{z.attachIframe(e,t),V.observeAttachShadow(e)},onStylesheetLoad:(e,t)=>{W.attachLinkElement(e,t)},keepIframeSrcFn:T});if(!t)return console.warn("Failed to snapshot the document");jt(Ft({type:Se.FullSnapshot,data:{node:t,initialOffset:Le(window)}}),e),at.forEach((e=>e.unlock())),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&W.adoptStyleSheets(document.adoptedStyleSheets,Wt.getId(document))};try{const e=[],t=e=>{var t;return Ze(gt)({mutationCb:U,mousemoveCb:(e,t)=>jt(Ft({type:Se.IncrementalSnapshot,data:{source:t,positions:e}})),mouseInteractionCb:e=>jt(Ft({type:Se.IncrementalSnapshot,data:Object.assign({source:Ie.MouseInteraction},e)})),scrollCb:q,viewportResizeCb:e=>jt(Ft({type:Se.IncrementalSnapshot,data:Object.assign({source:Ie.ViewportResize},e)})),inputCb:e=>jt(Ft({type:Se.IncrementalSnapshot,data:Object.assign({source:Ie.Input},e)})),mediaInteractionCb:e=>jt(Ft({type:Se.IncrementalSnapshot,data:Object.assign({source:Ie.MediaInteraction},e)})),styleSheetRuleCb:e=>jt(Ft({type:Se.IncrementalSnapshot,data:Object.assign({source:Ie.StyleSheetRule},e)})),styleDeclarationCb:e=>jt(Ft({type:Se.IncrementalSnapshot,data:Object.assign({source:Ie.StyleDeclaration},e)})),canvasMutationCb:B,fontCb:e=>jt(Ft({type:Se.IncrementalSnapshot,data:Object.assign({source:Ie.Font},e)})),selectionCb:e=>{jt(Ft({type:Se.IncrementalSnapshot,data:Object.assign({source:Ie.Selection},e)}))},blockClass:i,ignoreClass:s,ignoreSelector:a,maskTextClass:c,maskTextSelector:l,maskInputOptions:L,inlineStylesheet:u,sampling:y,recordDOM:S,recordCanvas:I,inlineImages:E,userTriggeredOnInput:M,collectFonts:x,doc:e,maskInputFn:f,maskTextFn:v,keepIframeSrcFn:T,blockSelector:o,slimDOMOptions:P,dataURLOptions:b,mirror:Wt,iframeManager:z,stylesheetManager:W,shadowDomManager:V,processedNodeManager:G,canvasManager:qt,ignoreCSSAttributes:R,plugins:(null===(t=null==O?void 0:O.filter((e=>e.observer)))||void 0===t?void 0:t.map((e=>({observer:e.observer,options:e.options,callback:t=>jt(Ft({type:Se.Plugin,data:{plugin:e.name,payload:t}}))}))))||[]},m)};z.addLoadListener((n=>{try{e.push(t(n.contentDocument))}catch(e){console.warn(e)}}));const n=()=>{Ut(),e.push(t(document)),Bt=!0};return"interactive"===document.readyState||"complete"===document.readyState?n():(e.push(xe("DOMContentLoaded",(()=>{jt(Ft({type:Se.DomContentLoaded,data:{}})),"DOMContentLoaded"===C&&n()}))),e.push(xe("load",(()=>{jt(Ft({type:Se.Load,data:{}})),"load"===C&&n()}),window))),()=>{e.forEach((e=>e())),G.destroy(),Bt=!1,De=void 0}}catch(e){console.warn(e)}}var Gt,Vt;zt.addCustomEvent=(e,t)=>{if(!Bt)throw new Error("please add custom event after start recording");jt(Ft({type:Se.Custom,data:{tag:e,payload:t}}))},zt.freezePage=()=>{at.forEach((e=>e.freeze()))},zt.takeFullSnapshot=e=>{if(!Bt)throw new Error("please take full snapshot after start recording");Ut(e)},zt.mirror=Wt,function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"}(Gt||(Gt={})),function(e){e[e.PLACEHOLDER=0]="PLACEHOLDER",e[e.ELEMENT_NODE=1]="ELEMENT_NODE",e[e.ATTRIBUTE_NODE=2]="ATTRIBUTE_NODE",e[e.TEXT_NODE=3]="TEXT_NODE",e[e.CDATA_SECTION_NODE=4]="CDATA_SECTION_NODE",e[e.ENTITY_REFERENCE_NODE=5]="ENTITY_REFERENCE_NODE",e[e.ENTITY_NODE=6]="ENTITY_NODE",e[e.PROCESSING_INSTRUCTION_NODE=7]="PROCESSING_INSTRUCTION_NODE",e[e.COMMENT_NODE=8]="COMMENT_NODE",e[e.DOCUMENT_NODE=9]="DOCUMENT_NODE",e[e.DOCUMENT_TYPE_NODE=10]="DOCUMENT_TYPE_NODE",e[e.DOCUMENT_FRAGMENT_NODE=11]="DOCUMENT_FRAGMENT_NODE"}(Vt||(Vt={}));var Kt=Uint8Array,Ht=Uint16Array,Zt=Uint32Array,$t=new Kt([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Jt=new Kt([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Xt=new Kt([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Qt=function(e,t){for(var n=new Ht(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];var i=new Zt(n[30]);for(r=1;r<30;++r)for(var o=n[r];o<n[r+1];++o)i[o]=o-n[r]<<5|r;return[n,i]},Yt=Qt($t,2),en=Yt[0],tn=Yt[1];en[28]=258,tn[258]=28;for(var nn=Qt(Jt,0)[1],rn=new Ht(32768),on=0;on<32768;++on){var sn=(43690&on)>>>1|(21845&on)<<1;sn=(61680&(sn=(52428&sn)>>>2|(13107&sn)<<2))>>>4|(3855&sn)<<4,rn[on]=((65280&sn)>>>8|(255&sn)<<8)>>>1}var an=function(e,t,n){for(var r=e.length,i=0,o=new Ht(t);i<r;++i)++o[e[i]-1];var s,a=new Ht(t);for(i=0;i<t;++i)a[i]=a[i-1]+o[i-1]<<1;if(n){s=new Ht(1<<t);var c=15-t;for(i=0;i<r;++i)if(e[i])for(var l=i<<4|e[i],u=t-e[i],d=a[e[i]-1]++<<u,p=d|(1<<u)-1;d<=p;++d)s[rn[d]>>>c]=l}else for(s=new Ht(r),i=0;i<r;++i)s[i]=rn[a[e[i]-1]++]>>>15-e[i];return s},cn=new Kt(288);for(on=0;on<144;++on)cn[on]=8;for(on=144;on<256;++on)cn[on]=9;for(on=256;on<280;++on)cn[on]=7;for(on=280;on<288;++on)cn[on]=8;var ln=new Kt(32);for(on=0;on<32;++on)ln[on]=5;var un=an(cn,9,0),dn=an(ln,5,0),pn=function(e){return(e/8>>0)+(7&e&&1)},hn=function(e,t,n){(null==t||t<0)&&(t=0),(null==n||n>e.length)&&(n=e.length);var r=new(e instanceof Ht?Ht:e instanceof Zt?Zt:Kt)(n-t);return r.set(e.subarray(t,n)),r},fn=function(e,t,n){n<<=7&t;var r=t/8>>0;e[r]|=n,e[r+1]|=n>>>8},vn=function(e,t,n){n<<=7&t;var r=t/8>>0;e[r]|=n,e[r+1]|=n>>>8,e[r+2]|=n>>>16},mn=function(e,t){for(var n=[],r=0;r<e.length;++r)e[r]&&n.push({s:r,f:e[r]});var i=n.length,o=n.slice();if(!i)return[new Kt(0),0];if(1==i){var s=new Kt(n[0].s+1);return s[n[0].s]=1,[s,1]}n.sort((function(e,t){return e.f-t.f})),n.push({s:-1,f:25001});var a=n[0],c=n[1],l=0,u=1,d=2;for(n[0]={s:-1,f:a.f+c.f,l:a,r:c};u!=i-1;)a=n[n[l].f<n[d].f?l++:d++],c=n[l!=u&&n[l].f<n[d].f?l++:d++],n[u++]={s:-1,f:a.f+c.f,l:a,r:c};var p=o[0].s;for(r=1;r<i;++r)o[r].s>p&&(p=o[r].s);var h=new Ht(p+1),f=gn(n[u-1],h,0);if(f>t){r=0;var v=0,m=f-t,g=1<<m;for(o.sort((function(e,t){return h[t.s]-h[e.s]||e.f-t.f}));r<i;++r){var y=o[r].s;if(!(h[y]>t))break;v+=g-(1<<f-h[y]),h[y]=t}for(v>>>=m;v>0;){var b=o[r].s;h[b]<t?v-=1<<t-h[b]++-1:++r}for(;r>=0&&v;--r){var w=o[r].s;h[w]==t&&(--h[w],++v)}f=t}return[new Kt(h),f]},gn=function(e,t,n){return-1==e.s?Math.max(gn(e.l,t,n+1),gn(e.r,t,n+1)):t[e.s]=n},yn=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new Ht(++t),r=0,i=e[0],o=1,s=function(e){n[r++]=e},a=1;a<=t;++a)if(e[a]==i&&a!=t)++o;else{if(!i&&o>2){for(;o>138;o-=138)s(32754);o>2&&(s(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(s(i),--o;o>6;o-=6)s(8304);o>2&&(s(o-3<<5|8208),o=0)}for(;o--;)s(i);o=1,i=e[a]}return[n.subarray(0,r),t]},bn=function(e,t){for(var n=0,r=0;r<t.length;++r)n+=e[r]*t[r];return n},wn=function(e,t,n){var r=n.length,i=pn(t+2);e[i]=255&r,e[i+1]=r>>>8,e[i+2]=255^e[i],e[i+3]=255^e[i+1];for(var o=0;o<r;++o)e[i+o+4]=n[o];return 8*(i+4+r)},Sn=function(e,t,n,r,i,o,s,a,c,l,u){fn(t,u++,n),++i[256];for(var d=mn(i,15),p=d[0],h=d[1],f=mn(o,15),v=f[0],m=f[1],g=yn(p),y=g[0],b=g[1],w=yn(v),S=w[0],I=w[1],k=new Ht(19),C=0;C<y.length;++C)k[31&y[C]]++;for(C=0;C<S.length;++C)k[31&S[C]]++;for(var M=mn(k,7),x=M[0],E=M[1],O=19;O>4&&!x[Xt[O-1]];--O);var T,R,_,D,N=l+5<<3,L=bn(i,cn)+bn(o,ln)+s,P=bn(i,p)+bn(o,v)+s+14+3*O+bn(k,x)+(2*k[16]+3*k[17]+7*k[18]);if(N<=L&&N<=P)return wn(t,u,e.subarray(c,c+l));if(fn(t,u,1+(P<L)),u+=2,P<L){T=an(p,h,0),R=p,_=an(v,m,0),D=v;var A=an(x,E,0);for(fn(t,u,b-257),fn(t,u+5,I-1),fn(t,u+10,O-4),u+=14,C=0;C<O;++C)fn(t,u+3*C,x[Xt[C]]);u+=3*O;for(var F=[y,S],j=0;j<2;++j){var U=F[j];for(C=0;C<U.length;++C){var q=31&U[C];fn(t,u,A[q]),u+=x[q],q>15&&(fn(t,u,U[C]>>>5&127),u+=U[C]>>>12)}}}else T=un,R=cn,_=dn,D=ln;for(C=0;C<a;++C)if(r[C]>255){q=r[C]>>>18&31,vn(t,u,T[q+257]),u+=R[q+257],q>7&&(fn(t,u,r[C]>>>23&31),u+=$t[q]);var B=31&r[C];vn(t,u,_[B]),u+=D[B],B>3&&(vn(t,u,r[C]>>>5&8191),u+=Jt[B])}else vn(t,u,T[r[C]]),u+=R[r[C]];return vn(t,u,T[256]),u+R[256]},In=new Zt([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]);new Kt(0);const kn=e=>{const t=Object.assign(Object.assign({},e),{v:"v1"});return function(e,t){for(var n="",r=0;r<e.length;){var i=e[r++];n+=String.fromCharCode(i)}return n}(function(e,t){void 0===t&&(t={});var n=function(){var e=1,t=0;return{p:function(n){for(var r=e,i=t,o=n.length,s=0;s!=o;){for(var a=Math.min(s+5552,o);s<a;++s)i+=r+=n[s];r%=65521,i%=65521}e=r,t=i},d:function(){return(e>>>8<<16|(255&t)<<8|t>>>8)+2*((255&e)<<23)}}}();n.p(e);var r=function(e,t,n,r,i){return function(e,t,n,r,i,o){var s=e.length,a=new Kt(2+s+5*(1+Math.floor(s/7e3))+4),c=a.subarray(2,a.length-4),l=0;if(!t||s<8)for(var u=0;u<=s;u+=65535){var d=u+65535;d<s?l=wn(c,l,e.subarray(u,d)):(c[u]=o,l=wn(c,l,e.subarray(u,s)))}else{for(var p=In[t-1],h=p>>>13,f=8191&p,v=(1<<n)-1,m=new Ht(32768),g=new Ht(v+1),y=Math.ceil(n/3),b=2*y,w=function(t){return(e[t]^e[t+1]<<y^e[t+2]<<b)&v},S=new Zt(25e3),I=new Ht(288),k=new Ht(32),C=0,M=0,x=(u=0,0),E=0,O=0;u<s;++u){var T=w(u),R=32767&u,_=g[T];if(m[R]=_,g[T]=R,E<=u){var D=s-u;if((C>7e3||x>24576)&&D>423){l=Sn(e,c,0,S,I,k,M,x,O,u-O,l),x=C=M=0,O=u;for(var N=0;N<286;++N)I[N]=0;for(N=0;N<30;++N)k[N]=0}var L=2,P=0,A=f,F=R-_&32767;if(D>2&&T==w(u-F))for(var j=Math.min(h,D)-1,U=Math.min(32767,u),q=Math.min(258,D);F<=U&&--A&&R!=_;){if(e[u+L]==e[u+L-F]){for(var B=0;B<q&&e[u+B]==e[u+B-F];++B);if(B>L){if(L=B,P=F,B>j)break;var W=Math.min(F,B-2),z=0;for(N=0;N<W;++N){var G=u-F+N+32768&32767,V=G-m[G]+32768&32767;V>z&&(z=V,_=G)}}}F+=(R=_)-(_=m[R])+32768&32767}if(P){S[x++]=268435456|tn[L]<<18|nn[P];var K=31&tn[L],H=31&nn[P];M+=$t[K]+Jt[H],++I[257+K],++k[H],E=u+L,++C}else S[x++]=e[u],++I[e[u]]}}l=Sn(e,c,o,S,I,k,M,x,O,u-O,l)}return hn(a,0,2+pn(l)+4)}(e,null==t.level?6:t.level,null==t.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):12+t.mem,0,0,!0)}(e,t);return function(e,t){var n=t.level,r=0==n?0:n<6?1:9==n?3:2;e[0]=120,e[1]=r<<6|(r?32-2*r:1)}(r,t),function(e,t,n){for(;n;++t)e[t]=n,n>>>=8}(r,r.length-4,n.d()),r}(function(e,t){var n=e.length;if("undefined"!=typeof TextEncoder)return(new TextEncoder).encode(e);for(var r=new Kt(e.length+(e.length>>>1)),i=0,o=function(e){r[i++]=e},s=0;s<n;++s){if(i+5>r.length){var a=new Kt(i+8+(n-s<<1));a.set(r),r=a}var c=e.charCodeAt(s);c<128?o(c):c<2048?(o(192|c>>>6),o(128|63&c)):c>55295&&c<57344?(o(240|(c=65536+(1047552&c)|1023&e.charCodeAt(++s))>>>18),o(128|c>>>12&63),o(128|c>>>6&63),o(128|63&c)):(o(224|c>>>12),o(128|c>>>6&63),o(128|63&c))}return hn(r,0,i)}(JSON.stringify(t))))};var Cn,Mn;(Mn=Cn||(Cn={}))[Mn.NotStarted=0]="NotStarted",Mn[Mn.Running=1]="Running",Mn[Mn.Stopped=2]="Stopped";const xn=(e,t)=>t.some((t=>e instanceof t));let En,On;const Tn=new WeakMap,Rn=new WeakMap,_n=new WeakMap;let Dn={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Tn.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ln(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Nn(e){Dn=e(Dn)}function Ln(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",o)},i=()=>{t(Ln(e.result)),r()},o=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",o)}));return _n.set(t,e),t}(e);if(Rn.has(e))return Rn.get(e);const t=function(e){return"function"==typeof e?function(e){return(On||(On=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(Pn(this),t),Ln(this.request)}:function(...t){return Ln(e.apply(Pn(this),t))}}(e):(e instanceof IDBTransaction&&function(e){if(Tn.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",o),e.removeEventListener("abort",o)},i=()=>{t(),r()},o=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",o),e.addEventListener("abort",o)}));Tn.set(e,t)}(e),xn(e,En||(En=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,Dn):e)}(e);return t!==e&&(Rn.set(e,t),_n.set(t,e)),t}const Pn=e=>_n.get(e);function An(e,t,{blocked:n,upgrade:r,blocking:i,terminated:o}={}){const s=indexedDB.open(e,t),a=Ln(s);return r&&s.addEventListener("upgradeneeded",(e=>{r(Ln(s.result),e.oldVersion,e.newVersion,Ln(s.transaction),e)})),n&&s.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{o&&e.addEventListener("close",(()=>o())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}function Fn(e,{blocked:t}={}){const n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",(e=>t(e.oldVersion,e))),Ln(n).then((()=>{}))}const jn=["get","getKey","getAll","getAllKeys","count"],Un=["put","add","delete","clear"],qn=new Map;function Bn(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(qn.get(t))return qn.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=Un.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!jn.includes(n))return;const o=async function(e,...t){const o=this.transaction(e,i?"readwrite":"readonly");let s=o.store;return r&&(s=s.index(t.shift())),(await Promise.all([s[n](...t),i&&o.done]))[0]};return qn.set(t,o),o}Nn((e=>({...e,get:(t,n,r)=>Bn(t,n)||e.get(t,n,r),has:(t,n)=>!!Bn(t,n)||e.has(t,n)})));const Wn=["continue","continuePrimaryKey","advance"],zn={},Gn=new WeakMap,Vn=new WeakMap,Kn={get(e,t){if(!Wn.includes(t))return e[t];let n=zn[t];return n||(n=zn[t]=function(...e){Gn.set(this,Vn.get(this)[t](...e))}),n}};async function*Hn(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;const n=new Proxy(t,Kn);for(Vn.set(n,t),_n.set(n,Pn(t));t;)yield n,t=await(Gn.get(n)||t.continue()),Gn.delete(n)}function Zn(e,t){return t===Symbol.asyncIterator&&xn(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&xn(e,[IDBIndex,IDBObjectStore])}Nn((e=>({...e,get:(t,n,r)=>Zn(t,n)?Hn:e.get(t,n,r),has:(t,n)=>Zn(t,n)||e.has(t,n)})));var $n,Jn=function(e,t){return c(void 0,void 0,void 0,(function(){return l(this,(function(n){switch(n.label){case 0:return[4,An(e,1,{upgrade:function(e){t.forEach((function(t){e.objectStoreNames.contains(t)||e.createObjectStore(t)}))}})];case 1:return[2,n.sent()]}}))}))},Xn=function(e){var t=e.loggerProvider,n=e.apiKey,r=e.configKeys;return c(void 0,void 0,void 0,(function(){var e,i,o,s,u,h,f,v,m;return l(this,(function(g){switch(g.label){case 0:return e="".concat(n.substring(0,10),"_amp_config"),[4,Jn(e,r)];case 1:return i=g.sent(),o="".concat(n.substring(0,10),"_amp_config_meta"),[4,(y=o,c(void 0,void 0,void 0,(function(){return l(this,(function(e){switch(e.label){case 0:return[4,An(y,1,{upgrade:function(e){e.objectStoreNames.contains("lastFetchedSessionId")||e.createObjectStore("lastFetchedSessionId")}})];case 1:return[2,e.sent()]}}))})))];case 2:s=g.sent(),g.label=3;case 3:return g.trys.push([3,8,,9]),[4,s.get("lastFetchedSessionId","sessionId")];case 4:return(u=g.sent())&&Date.now()-u>=2592e5?[4,Fn(e)]:[3,7];case 5:return g.sent(),[4,Jn(n,r)];case 6:i=g.sent(),g.label=7;case 7:return[3,9];case 8:return h=g.sent(),t.warn("Failed to reset store: ".concat(h)),[3,9];case 9:return f=function(e,n){return c(void 0,void 0,void 0,(function(){var r,o,c,u,h,f;return l(this,(function(v){switch(v.label){case 0:return v.trys.push([0,7,,8]),n?[4,s.put("lastFetchedSessionId",n,"sessionId")]:[3,2];case 1:v.sent(),v.label=2;case 2:for(u in r=function(t){var n,r;return l(this,(function(o){switch(o.label){case 0:return n=e.configs[t],r=i.transaction(t,"readwrite"),[4,Promise.all(p(p([],d(Object.keys(n).map((function(e){return r.store.put(a({},n[e]),e)}))),!1),[r.done],!1))];case 1:return o.sent(),[2]}}))},o=e.configs,c=[],o)c.push(u);h=0,v.label=3;case 3:return h<c.length?(u=c[h])in o?[5,r(u)]:[3,5]:[3,6];case 4:v.sent(),v.label=5;case 5:return h++,[3,3];case 6:return[3,8];case 7:return f=v.sent(),t.warn("Failed to store remote config: ".concat(f)),[3,8];case 8:return[2]}}))}))},v=function(){return c(void 0,void 0,void 0,(function(){var e;return l(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,s.get("lastFetchedSessionId","sessionId")];case 1:return[2,n.sent()];case 2:return e=n.sent(),t.warn("Failed to fetch lastFetchedSessionId: ".concat(e)),[3,3];case 3:return[2,void 0]}}))}))},m=function(e,n){return c(void 0,void 0,void 0,(function(){var r;return l(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,i.get(e,n)];case 1:return[2,o.sent()];case 2:return r=o.sent(),t.warn("Failed to fetch remote config: ".concat(r)),[3,3];case 3:return[2,void 0]}}))}))},[2,{storeRemoteConfig:f,getRemoteConfig:m,getLastFetchedSessionId:v}]}var y}))}))},Qn="Remote config fetch rejected due to timeout after 5 seconds",Yn=function(){function e(e){var t=e.localConfig,n=e.configKeys,r=this;this.retryTimeout=1e3,this.attempts=0,this.sessionTargetingMatch=!1,this.getRemoteConfig=function(e,t,n){return c(r,void 0,void 0,(function(){var r,i,o,s;return l(this,(function(a){switch(a.label){case 0:return this.remoteConfigIDBStore?[4,this.remoteConfigIDBStore.getRemoteConfig(e,t)]:[3,3];case 1:return r=a.sent(),[4,this.remoteConfigIDBStore.getLastFetchedSessionId()];case 2:if(i=a.sent(),r&&i===n)return[2,r];a.label=3;case 3:return[4,this.fetchWithTimeout(n)];case 4:return(o=a.sent())&&(s=o.configs&&o.configs[e])?[2,s[t]]:[2,void 0]}}))}))},this.fetchWithTimeout=function(e){return c(r,void 0,void 0,(function(){var t,n,r;return l(this,(function(i){switch(i.label){case 0:return t=new AbortController,n=setTimeout((function(){return t.abort()}),5e3),[4,this.fetchRemoteConfig(t.signal,e)];case 1:return r=i.sent(),clearTimeout(n),[2,r]}}))}))},this.fetchRemoteConfig=function(e,t){return c(r,void 0,void 0,(function(){var n,r,i,o,c,u;return l(this,(function(l){switch(l.label){case 0:if(t===this.lastFetchedSessionId&&this.attempts>=this.localConfig.flushMaxRetries)return[2,this.completeRequest({err:"Remote config fetch rejected due to exceeded retry count"})];if(e.aborted)return[2,this.completeRequest({err:Qn})];t!==this.lastFetchedSessionId&&(this.lastFetchedSessionId=t,this.attempts=0),l.label=1;case 1:return l.trys.push([1,3,,4]),n=new URLSearchParams({api_key:this.localConfig.apiKey,config_keys:this.configKeys.join(",")}),r={headers:{"Content-Type":"application/json",Accept:"*/*"},method:"GET"},i="".concat(this.getServerUrl(),"?").concat(n.toString()),this.attempts+=1,[4,fetch(i,a(a({},r),{signal:e}))];case 2:if(null===(o=l.sent()))return[2,this.completeRequest({err:"Unexpected error occurred"})];switch((new C).buildStatus(o.status)){case s.Success:return[2,this.parseAndStoreConfig(o,t)];case s.Failed:return[2,this.retryFetch(e,t)];default:return[2,this.completeRequest({err:"Network error occurred, remote config fetch failed"})]}case 3:return c=l.sent(),u=c,e.aborted?[2,this.completeRequest({err:Qn})]:[2,this.completeRequest({err:u.message})];case 4:return[2]}}))}))},this.retryFetch=function(e,t){return c(r,void 0,void 0,(function(){var n=this;return l(this,(function(r){switch(r.label){case 0:return[4,new Promise((function(e){return setTimeout(e,n.attempts*n.retryTimeout)}))];case 1:return r.sent(),[2,this.fetchRemoteConfig(e,t)]}}))}))},this.parseAndStoreConfig=function(e,t){return c(r,void 0,void 0,(function(){var n;return l(this,(function(r){switch(r.label){case 0:return[4,e.json()];case 1:return n=r.sent(),this.completeRequest({success:"Remote config successfully fetched"}),this.remoteConfigIDBStore&&this.remoteConfigIDBStore.storeRemoteConfig(n,t),[2,n]}}))}))},this.localConfig=t,this.configKeys=n}return e.prototype.initialize=function(){return c(this,void 0,void 0,(function(){var e;return l(this,(function(t){switch(t.label){case 0:return e=this,[4,Xn({apiKey:this.localConfig.apiKey,loggerProvider:this.localConfig.loggerProvider,configKeys:this.configKeys})];case 1:return e.remoteConfigIDBStore=t.sent(),[2]}}))}))},e.prototype.getServerUrl=function(){return this.localConfig.serverZone===o.STAGING?"https://sr-client-cfg.stag2.amplitude.com/config":this.localConfig.serverZone===o.EU?"https://sr-client-cfg.eu.amplitude.com/config":"https://sr-client-cfg.amplitude.com/config"},e.prototype.completeRequest=function(e){var t=e.err,n=e.success;if(t)throw new Error(t);n&&this.localConfig.loggerProvider.log(n)},e}(),er=function(e){var t=e.localConfig,n=e.configKeys;return c(void 0,void 0,void 0,(function(){var e;return l(this,(function(r){switch(r.label){case 0:return[4,(e=new Yn({localConfig:t,configKeys:n})).initialize()];case 1:return r.sent(),[2,e]}}))}))},tr=function(){function e(e,t){this.localConfig=new z(e,t)}return e.prototype.initialize=function(){return c(this,void 0,void 0,(function(){var e;return l(this,(function(t){switch(t.label){case 0:return e=this,[4,er({localConfig:this.localConfig,configKeys:["sessionReplay"]})];case 1:return e.remoteConfigFetch=t.sent(),[2]}}))}))},e.prototype.generateJoinedConfig=function(e){var t,n,r;return c(this,void 0,void 0,(function(){var i,o,s,c,p,h,f,v,m,g,y,b,w,S,I,k,C,M,x;return l(this,(function(l){switch(l.label){case 0:(i=a({},this.localConfig)).optOut=this.localConfig.optOut,i.captureEnabled=!0,l.label=1;case 1:return l.trys.push([1,4,,5]),this.remoteConfigFetch?[4,this.remoteConfigFetch.getRemoteConfig("sessionReplay","sr_sampling_config",e)]:[2,i];case 2:return s=l.sent(),[4,this.remoteConfigFetch.getRemoteConfig("sessionReplay","sr_privacy_config",e)];case 3:return c=l.sent(),(s||c)&&(o={},s&&(o.sr_sampling_config=s),c&&(o.sr_privacy_config=c)),[3,5];case 4:return p=l.sent(),h=p,this.localConfig.loggerProvider.warn(h.message),i.captureEnabled=!0,[3,5];case 5:if(!o)return[2,i];if(f=o.sr_sampling_config,v=o.sr_privacy_config,f&&Object.keys(f).length>0?(Object.prototype.hasOwnProperty.call(f,"capture_enabled")?i.captureEnabled=f.capture_enabled:i.captureEnabled=!1,f.sample_rate&&(i.sampleRate=f.sample_rate)):(i.captureEnabled=!0,this.localConfig.loggerProvider.debug("Remote config successfully fetched, but no values set for project, Session Replay capture enabled.")),v){m=null!==(t=i.privacyConfig)&&void 0!==t?t:{},g={defaultMaskLevel:null!==(r=null!==(n=v.defaultMaskLevel)&&void 0!==n?n:m.defaultMaskLevel)&&void 0!==r?r:"medium",blockSelector:[],maskSelector:[],unmaskSelector:[]},y=function(e){var t,n,r,i,o,s,a,c,l,d={};"string"==typeof e.blockSelector&&(e.blockSelector=[e.blockSelector]);try{for(var p=u(null!==(a=e.blockSelector)&&void 0!==a?a:[]),h=p.next();!h.done;h=p.next())d[h.value]="block"}catch(e){t={error:e}}finally{try{h&&!h.done&&(n=p.return)&&n.call(p)}finally{if(t)throw t.error}}try{for(var f=u(null!==(c=e.maskSelector)&&void 0!==c?c:[]),v=f.next();!v.done;v=f.next())d[v.value]="mask"}catch(e){r={error:e}}finally{try{v&&!v.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}try{for(var m=u(null!==(l=e.unmaskSelector)&&void 0!==l?l:[]),g=m.next();!g.done;g=m.next())d[g.value]="unmask"}catch(e){o={error:e}}finally{try{g&&!g.done&&(s=m.return)&&s.call(m)}finally{if(o)throw o.error}}return d},b=a(a({},y(m)),y(v));try{for(w=u(Object.entries(b)),S=w.next();!S.done;S=w.next())I=d(S.value,2),k=I[0],"mask"===(C=I[1])?g.maskSelector.push(k):"block"===C?g.blockSelector.push(k):"unmask"===C&&g.unmaskSelector.push(k)}catch(e){M={error:e}}finally{try{S&&!S.done&&(x=w.return)&&x.call(w)}finally{if(M)throw M.error}}i.privacyConfig=g}return[2,i]}}))}))},e}(),nr=function(e,t){return c(void 0,void 0,void 0,(function(){var n;return l(this,(function(r){switch(r.label){case 0:return[4,(n=new tr(e,t)).initialize()];case 1:return r.sent(),[2,n]}}))}))},rr="medium";!function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"}($n||($n={}));var ir,or=function(e,t,n){switch(t){case"light":if("input"!==e)return!0;var r=n?function(e){var t=e.type;return e.hasAttribute("data-rr-is-password")?"password":t?t.toLowerCase():null}(n):"";return!(!r||!["password","hidden","email","tel"].includes(r)&&!n.autocomplete.startsWith("cc-"));case"medium":case"conservative":return!0;default:return or(e,rr,n)}},sr=function(e,t){return function(n,r){return function(e,t,n){var r,i,o;if(void 0===t&&(t={defaultMaskLevel:rr}),n){if(n.closest("."+B))return!0;if((null!==(r=t.maskSelector)&&void 0!==r?r:[]).some((function(e){return n.closest(e)})))return!0;if(n.closest(".amp-unmask"))return!1;if((null!==(i=t.unmaskSelector)&&void 0!==i?i:[]).some((function(e){return n.closest(e)})))return!1}return or(e,null!==(o=t.defaultMaskLevel)&&void 0!==o?o:rr,n)}(e,t,r)?n.replace(/[^\s]/g,"*"):n}},ar=function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return t},cr="Session replay event batch rejected due to exceeded retry count",lr="Failed to store session replay events in IndexedDB",ur=function(){function e(e){var t=e.loggerProvider;this.storageKey="",this.retryTimeout=1e3,this.scheduled=null,this.queue=[],this.loggerProvider=t}return e.prototype.sendEventsList=function(e){this.addToQueue(a(a({},e),{attempts:0,timeout:0}))},e.prototype.getServerUrl=function(e){return e===o.STAGING?"https://api-sr.stag2.amplitude.com/sessions/v2/track":e===o.EU?"https://api-sr.eu.amplitude.com/sessions/v2/track":"https://api-sr.amplitude.com/sessions/v2/track"},e.prototype.addToQueue=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=t.filter((function(t){return t.attempts<(t.flushMaxRetries||0)?(t.attempts+=1,!0):(e.completeRequest({context:t,err:"".concat(cr,", batch sequence id, ").concat(t.sequenceId)}),!1)}));r.forEach((function(t){e.queue=e.queue.concat(t),0!==t.timeout?setTimeout((function(){t.timeout=0,e.schedule(0)}),t.timeout):e.schedule(0)}))},e.prototype.schedule=function(e){var t=this;this.scheduled||(this.scheduled=setTimeout((function(){t.flush(!0).then((function(){t.queue.length>0&&t.schedule(e)}))}),e))},e.prototype.flush=function(e){return void 0===e&&(e=!1),c(this,void 0,void 0,(function(){var t,n,r=this;return l(this,(function(i){switch(i.label){case 0:return t=[],n=[],this.queue.forEach((function(e){return 0===e.timeout?t.push(e):n.push(e)})),this.queue=n,this.scheduled&&(clearTimeout(this.scheduled),this.scheduled=null),[4,Promise.all(t.map((function(t){return r.send(t,e)})))];case 1:return i.sent(),[2]}}))}))},e.prototype.send=function(e,t){return void 0===t&&(t=!0),c(this,void 0,void 0,(function(){var n,r,i,o,s,a,c,u,d,p,h,f;return l(this,(function(l){switch(l.label){case 0:if(!(n=e.apiKey))return[2,this.completeRequest({context:e,err:"Session replay event batch not sent due to missing api key"})];if(!(r=e.deviceId))return[2,this.completeRequest({context:e,err:"Session replay event batch not sent due to missing device ID"})];v=P(),i=(null==v?void 0:v.location)?v.location.href:"",o="0.2.5",s=e.sampleRate,a=new URLSearchParams({device_id:r,session_id:"".concat(e.sessionId),seq_number:"".concat(e.sequenceId)}),c={version:1,events:e.events},l.label=1;case 1:return l.trys.push([1,3,,4]),u={headers:{"Content-Type":"application/json",Accept:"*/*",Authorization:"Bearer ".concat(n),"X-Client-Version":o,"X-Client-Url":i,"X-Client-Sample-Rate":"".concat(s)},body:JSON.stringify(c),method:"POST"},d="".concat(this.getServerUrl(e.serverZone),"?").concat(a.toString()),[4,fetch(d,u)];case 2:if(null===(p=l.sent()))return this.completeRequest({context:e,err:"Unexpected error occurred"}),[2];if(t)this.handleReponse(p.status,e);else{h="";try{h=JSON.stringify(p.body,null,2)}catch(e){}this.completeRequest({context:e,success:"".concat(p.status,": ").concat(h)})}return[3,4];case 3:return f=l.sent(),this.completeRequest({context:e,err:f}),[3,4];case 4:return[2]}var v}))}))},e.prototype.handleReponse=function(e,t){switch((new C).buildStatus(e)){case s.Success:this.handleSuccessResponse(t);break;case s.Failed:this.handleOtherResponse(t);break;default:this.completeRequest({context:t,err:"Network error occurred, event batch rejected"})}},e.prototype.handleSuccessResponse=function(e){var t;this.completeRequest({context:e,success:(t=e.sessionId,"Session replay event batch tracked successfully for session id ".concat(t))})},e.prototype.handleOtherResponse=function(e){this.addToQueue(a(a({},e),{timeout:e.attempts*this.retryTimeout}))},e.prototype.completeRequest=function(e){var t=e.context,n=e.err,r=e.success;t.onComplete(t.sequenceId),n?this.loggerProvider.warn(n):r&&this.loggerProvider.log(r)},e}();!function(e){e.RECORDING="recording",e.SENT="sent"}(ir||(ir={}));var dr="sessionCurrentSequence",pr="sequencesToSend",hr=function(){var e=P();return new Promise((function(t,n){if(!e)return n(new Error("Global scope not found"));if(!e.indexedDB)return n(new Error("Session Replay: cannot find indexedDB"));try{var r=e.indexedDB.open("keyval-store");r.onupgradeneeded=function(){1===r.result.version&&(r.result.close(),r.transaction&&r.transaction.abort(),e.indexedDB.deleteDatabase("keyval-store"),t())},r.onsuccess=function(){t(r.result)}}catch(e){n(e)}}))},fr=function(e){return c(void 0,void 0,void 0,(function(){var t;return l(this,(function(n){switch(n.label){case 0:return e.length>0?(t=e.splice(0,10),[4,Promise.all(t)]):[3,2];case 1:return n.sent(),[3,0];case 2:return[2]}}))}))},vr=function(e){var t,n;return e.objectStoreNames.contains(dr)||(n=e.createObjectStore(dr,{keyPath:"sessionId"})),e.objectStoreNames.contains(pr)||(t=e.createObjectStore(pr,{keyPath:"sequenceId",autoIncrement:!0})).createIndex("sessionId","sessionId"),{sequencesStore:t,currentSequenceStore:n}},mr=function(e){return c(void 0,void 0,void 0,(function(){return l(this,(function(t){switch(t.label){case 0:return[4,An(e,1,{upgrade:vr})];case 1:return[2,t.sent()]}}))}))},gr=function(){function e(e){var t=e.loggerProvider,n=e.apiKey,r=this;this.storageKey="",this.maxPersistedEventsSize=1e6,this.interval=500,this.timeAtLastSplit=null,this.shouldSplitEventsList=function(e,t){var n=new Blob([t]).size;return new Blob(e).size+n>=r.maxPersistedEventsSize||!!(null!==r.timeAtLastSplit&&Date.now()-r.timeAtLastSplit>r.interval&&e.length)&&(r.interval=Math.min(1e4,r.interval+500),r.timeAtLastSplit=Date.now(),!0)},this.getSequencesToSend=function(){return c(r,void 0,void 0,(function(){var e,t;return l(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,null===(t=this.db)||void 0===t?void 0:t.getAll(pr)];case 1:return[2,n.sent()];case 2:return e=n.sent(),this.loggerProvider.warn("".concat(lr,": ").concat(e)),[3,3];case 3:return[2,void 0]}}))}))},this.storeCurrentSequence=function(e){return c(r,void 0,void 0,(function(){var t,n,r;return l(this,(function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),this.db?[4,this.db.get(dr,e)]:[2,void 0];case 1:return(t=i.sent())?[4,this.db.put(pr,{sessionId:e,events:t.events})]:[2,void 0];case 2:return n=i.sent(),[4,this.db.put(dr,{sessionId:e,events:[]})];case 3:return i.sent(),[2,a(a({},t),{sessionId:e,sequenceId:n})];case 4:return r=i.sent(),this.loggerProvider.warn("".concat(lr,": ").concat(r)),[3,5];case 5:return[2,void 0]}}))}))},this.addEventToCurrentSequence=function(e,t){return c(r,void 0,void 0,(function(){var n,r,i,o,s,a,c;return l(this,(function(l){switch(l.label){case 0:return l.trys.push([0,10,,11]),(n=null===(c=this.db)||void 0===c?void 0:c.transaction(dr,"readwrite"))?[4,n.store.get(e)]:[2];case 1:return(r=l.sent())?[3,3]:[4,n.store.put({sessionId:e,events:[t]})];case 2:return l.sent(),[2];case 3:return i=void 0,this.shouldSplitEventsList(r.events,t)?(i=r.events,[4,n.store.put({sessionId:e,events:[t]})]):[3,5];case 4:return l.sent(),[3,7];case 5:return o=r.events.concat(t),[4,n.store.put({sessionId:e,events:o})];case 6:l.sent(),l.label=7;case 7:return[4,n.done];case 8:return l.sent(),i?[4,this.storeSendingEvents(e,i)]:[2,void 0];case 9:return(s=l.sent())?[2,{events:i,sessionId:e,sequenceId:s}]:[2,void 0];case 10:return a=l.sent(),this.loggerProvider.warn("".concat(lr,": ").concat(a)),[3,11];case 11:return[2,void 0]}}))}))},this.storeSendingEvents=function(e,t){return c(r,void 0,void 0,(function(){var n,r;return l(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,null===(r=this.db)||void 0===r?void 0:r.put(pr,{sessionId:e,events:t})];case 1:return[2,i.sent()];case 2:return n=i.sent(),this.loggerProvider.warn("".concat(lr,": ").concat(n)),[3,3];case 3:return[2,void 0]}}))}))},this.cleanUpSessionEventsStore=function(e){return c(r,void 0,void 0,(function(){var t,n;return l(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,null===(n=this.db)||void 0===n?void 0:n.delete(pr,e)];case 1:return r.sent(),[3,3];case 2:return t=r.sent(),this.loggerProvider.warn("".concat(lr,": ").concat(t)),[3,3];case 3:return[2]}}))}))},this.transitionFromKeyValStore=function(e){return c(r,void 0,void 0,(function(){var t,n,r,i,o,s,a,u,d=this;return l(this,(function(p){switch(p.label){case 0:return p.trys.push([0,6,,7]),[4,hr()];case 1:if(!(t=p.sent()))return[2];n=function(e,t){return c(d,void 0,void 0,(function(){var n,r,i=this;return l(this,(function(o){switch(o.label){case 0:return n=t.sessionSequences,r=[],Object.keys(n).forEach((function(o){var s=parseInt(o,10),a=n[s];if(s===t.currentSequenceId){var u=a.events.map((function(t){return c(i,void 0,void 0,(function(){return l(this,(function(n){return[2,this.addEventToCurrentSequence(e,t)]}))}))}));r.concat(u)}else a.status!==ir.SENT&&r.push(i.storeSendingEvents(e,a.events))})),[4,fr(r)];case 1:return o.sent(),[2]}}))}))},r="".concat(h,"_").concat(this.apiKey.substring(0,10)),p.label=2;case 2:return p.trys.push([2,4,,5]),i=t.transaction("keyval").objectStore("keyval").getAll(r),o=new Promise((function(t){i.onsuccess=function(r){return c(d,void 0,void 0,(function(){var i,o,s,a=this;return l(this,(function(c){switch(c.label){case 0:return i=r&&r.target.result,(o=i&&i[0])?(s=[],Object.keys(o).forEach((function(t){var r=parseInt(t,10),i=o[r];if(e===r)s.push(n(r,i));else{var c=i.sessionSequences;Object.keys(c).forEach((function(e){var t=parseInt(e,10);c[t].status!==ir.SENT&&s.push(a.storeSendingEvents(r,c[t].events))}))}})),[4,fr(s)]):[3,2];case 1:c.sent(),c.label=2;case 2:return t(),[2]}}))}))}})),[4,o];case 3:return p.sent(),(s=P())&&s.indexedDB.deleteDatabase("keyval-store"),[3,5];case 4:return a=p.sent(),this.loggerProvider.warn("Failed to transition session replay events from keyval to new store: ".concat(a)),[3,5];case 5:return[3,7];case 6:return u=p.sent(),this.loggerProvider.warn("Failed to access keyval store: ".concat(u,". For more information, visit: https://www.docs.developers.amplitude.com/session-replay/sdks/standalone/#indexeddb-best-practices")),[3,7];case 7:return[2]}}))}))},this.loggerProvider=t,this.apiKey=n}return e.prototype.initialize=function(e){return c(this,void 0,void 0,(function(){var t,n;return l(this,(function(r){switch(r.label){case 0:return t="".concat(this.apiKey.substring(0,10),"_amp_session_replay_events"),n=this,[4,mr(t)];case 1:return n.db=r.sent(),this.timeAtLastSplit=Date.now(),[4,this.transitionFromKeyValStore(e)];case 2:return r.sent(),[2]}}))}))},e}(),yr=function(e){var t=e.loggerProvider,n=e.apiKey,r=e.sessionId;return c(void 0,void 0,void 0,(function(){var e;return l(this,(function(i){switch(i.label){case 0:return[4,(e=new gr({loggerProvider:t,apiKey:n})).initialize(r)];case 1:return i.sent(),[2,e]}}))}))},br=function(e){var t=e.config,n=e.sessionId;return c(void 0,void 0,void 0,(function(){function e(e){return void 0===e&&(e=!1),c(this,void 0,void 0,(function(){return l(this,(function(t){return r?[2,r.flush(e)]:[2]}))}))}var r,i,o,s,a,u;return l(this,(function(d){switch(d.label){case 0:return r=new ur({loggerProvider:t.loggerProvider}),[4,yr({loggerProvider:t.loggerProvider,apiKey:t.apiKey,sessionId:n})];case 1:return i=d.sent(),o=function(e){var n=e.events,o=e.sessionId,s=e.deviceId,a=e.sequenceId;r.sendEventsList({events:n,sequenceId:a,sessionId:o,flushMaxRetries:t.flushMaxRetries,apiKey:t.apiKey,deviceId:s,sampleRate:t.sampleRate,serverZone:t.serverZone,onComplete:i.cleanUpSessionEventsStore.bind(i)})},s=function(e){var n=e.sessionId,r=e.deviceId;i.storeCurrentSequence(n).then((function(e){e&&o({sequenceId:e.sequenceId,events:e.events,sessionId:e.sessionId,deviceId:r})})).catch((function(e){t.loggerProvider.warn("Failed to get current sequence of session replay events for session:",e)}))},a=function(e){var t=e.deviceId;return c(void 0,void 0,void 0,(function(){var e;return l(this,(function(n){switch(n.label){case 0:return[4,i.getSequencesToSend()];case 1:return(e=n.sent())&&e.forEach((function(e){o({sequenceId:e.sequenceId,events:e.events,sessionId:e.sessionId,deviceId:t})})),[2]}}))}))},u=function(e){var n=e.event,r=e.sessionId,s=e.deviceId;i.addEventToCurrentSequence(r,n).then((function(e){return e&&o({sequenceId:e.sequenceId,events:e.events,sessionId:e.sessionId,deviceId:s})})).catch((function(e){t.loggerProvider.warn("Failed to add event to session replay capture:",e)}))},[2,{sendCurrentSequenceEvents:s,addEvent:u,sendStoredEvents:a,flush:e}]}}))}))},wr=function(e){var t=e.sessionId,n=e.deviceId;this.deviceId=n,this.sessionId=t,t&&n&&(this.sessionReplayId=function(e,t){return"".concat(t,"/").concat(e)}(t,n))},Sr=function(){function e(){var e=this;this.name="@amplitude/session-replay-browser",this.recordCancelCallback=null,this.blurListener=function(){e.stopRecordingAndSendEvents()},this.focusListener=function(){e.initialize()},this.stopRecordingEvents=function(){try{e.recordCancelCallback&&e.recordCancelCallback(),e.recordCancelCallback=null}catch(n){var t=n;e.loggerProvider.warn("Error occurred while stopping recording: ".concat(t.toString()))}},this.loggerProvider=new g}return e.prototype.init=function(e,t){return v(this._init(e,t))},e.prototype.removeInvalidSelectors=function(){var e;if(null===(e=this.config)||void 0===e?void 0:e.privacyConfig){var t=document.createDocumentFragment(),n=function(e){if(void 0===e&&(e=[]),"string"==typeof e&&(e=[e]),0!==(e=e.filter((function(e){try{t.querySelector(e)}catch(t){return console.warn('[session-replay-browser] omitting selector "'.concat(e,'" because it is invalid')),!1}return!0}))).length)return e};this.config.privacyConfig.blockSelector=n(this.config.privacyConfig.blockSelector),this.config.privacyConfig.maskSelector=n(this.config.privacyConfig.maskSelector),this.config.privacyConfig.unmaskSelector=n(this.config.privacyConfig.unmaskSelector)}},e.prototype._init=function(e,t){return c(this,void 0,void 0,(function(){var n,r,i,o;return l(this,(function(s){switch(s.label){case 0:return this.loggerProvider=t.loggerProvider||new g,this.identifiers=new wr({sessionId:t.sessionId,deviceId:t.deviceId}),n=this,[4,nr(e,t)];case 1:return n.joinedConfigGenerator=s.sent(),r=this,[4,this.joinedConfigGenerator.generateJoinedConfig(this.identifiers.sessionId)];case 2:return r.config=s.sent(),this.loggerProvider.debug(JSON.stringify({name:"joined privacy config",privacyConfig:this.config.privacyConfig},null,2)),this.removeInvalidSelectors(),i=this,[4,br({config:this.config,sessionId:this.identifiers.sessionId})];case 3:return i.eventsManager=s.sent(),this.loggerProvider.log("Installing @amplitude/session-replay-browser."),(o=P())&&(o.removeEventListener("blur",this.blurListener),o.removeEventListener("focus",this.focusListener),o.addEventListener("blur",this.blurListener),o.addEventListener("focus",this.focusListener)),o&&o.document&&o.document.hasFocus()&&this.initialize(!0),[2]}}))}))},e.prototype.setSessionId=function(e,t){return v(this.asyncSetSessionId(e,t))},e.prototype.asyncSetSessionId=function(e,t){return c(this,void 0,void 0,(function(){var n,r,i;return l(this,(function(o){switch(o.label){case 0:return(n=this.identifiers&&this.identifiers.sessionId)&&this.stopRecordingAndSendEvents(n),r=t||this.getDeviceId(),this.identifiers=new wr({sessionId:e,deviceId:r}),this.joinedConfigGenerator&&n?(i=this,[4,this.joinedConfigGenerator.generateJoinedConfig(this.identifiers.sessionId)]):[3,2];case 1:i.config=o.sent(),o.label=2;case 2:return this.recordEvents(),[2]}}))}))},e.prototype.getSessionReplayDebugPropertyValue=function(){var e="";return this.config&&(e=ar(this.config.apiKey).toString()),JSON.stringify({appHash:e})},e.prototype.getSessionReplayProperties=function(){var e;if(!this.config||!this.identifiers)return this.loggerProvider.error("Session replay init has not been called, cannot get session recording properties."),{};var t=!!this.config.debugMode;if(this.getShouldRecord(t)){var n=((e={})[j]=this.identifiers.sessionReplayId?this.identifiers.sessionReplayId:null,e);return this.config.debugMode&&(n[q]=this.getSessionReplayDebugPropertyValue()),n}return{}},e.prototype.stopRecordingAndSendEvents=function(e){var t;this.stopRecordingEvents();var n=e||(null===(t=this.identifiers)||void 0===t?void 0:t.sessionId),r=this.getDeviceId();this.eventsManager&&n&&r&&this.eventsManager.sendCurrentSequenceEvents({sessionId:n,deviceId:r})},e.prototype.initialize=function(e){var t;if(void 0===e&&(e=!1),null===(t=this.identifiers)||void 0===t?void 0:t.sessionId){var n=this.getDeviceId();n?(this.eventsManager&&e&&this.eventsManager.sendStoredEvents({deviceId:n}),this.recordEvents()):this.loggerProvider.log("Session is not being recorded due to lack of device id.")}else this.loggerProvider.log("Session is not being recorded due to lack of session id.")},e.prototype.shouldOptOut=function(){var e,t,n;return(null===(e=this.config)||void 0===e?void 0:e.instanceName)&&(n=L(this.config.instanceName).identityStore.getIdentity().optOut),void 0!==n?n:null===(t=this.config)||void 0===t?void 0:t.optOut},e.prototype.getShouldRecord=function(e){if(void 0===e&&(e=!1),!this.identifiers||!this.config||!this.identifiers.sessionId)return this.loggerProvider.error("Session is not being recorded due to lack of config, please call sessionReplay.init."),!1;if(!this.config.captureEnabled)return this.loggerProvider.log("Session ".concat(this.identifiers.sessionId," not being captured due to capture being disabled for project.")),!1;var t=P();if(!e&&t&&t.document&&!t.document.hasFocus())return this.loggerProvider.log("Session ".concat(this.identifiers.sessionId," temporarily not recording due to lack of browser focus.")),!1;if(this.shouldOptOut())return this.loggerProvider.log("Opting session ".concat(this.identifiers.sessionId," out of recording due to optOut config.")),!1;var n,r,i,o=(n=this.identifiers.sessionId,r=this.config.sampleRate,i=ar(n.toString()),31*Math.abs(i)%100/100<r);return o||this.loggerProvider.log("Opting session ".concat(this.identifiers.sessionId," out of recording due to sample rate.")),o},e.prototype.getBlockSelectors=function(){var e,t;return null===(t=null===(e=this.config)||void 0===e?void 0:e.privacyConfig)||void 0===t?void 0:t.blockSelector},e.prototype.getMaskTextSelectors=function(){var e,t,n,r;return"conservative"===(null===(t=null===(e=this.config)||void 0===e?void 0:e.privacyConfig)||void 0===t?void 0:t.defaultMaskLevel)?"*":(null===(r=null===(n=this.config)||void 0===n?void 0:n.privacyConfig)||void 0===r?void 0:r.maskSelector)||void 0},e.prototype.recordEvents=function(){var e,t=this,n=this.getShouldRecord(),r=null===(e=this.identifiers)||void 0===e?void 0:e.sessionId;if(n&&r&&this.config){this.stopRecordingEvents();var i=this.config.privacyConfig;this.recordCancelCallback=zt({emit:function(e){var n=P();if(n&&n.document&&!n.document.hasFocus()||!t.getShouldRecord())t.stopRecordingAndSendEvents();else{var i=JSON.stringify(e),o=t.getDeviceId();o&&t.eventsManager&&t.eventsManager.addEvent({event:i,sessionId:r,deviceId:o})}},packFn:kn,maskAllInputs:!0,maskTextClass:B,blockClass:"amp-block",blockSelector:this.getBlockSelectors(),maskInputFn:sr("input",i),maskTextFn:sr("text",i),maskTextSelector:this.getMaskTextSelectors(),recordCanvas:!1,errorHandler:function(e){var n=e;if(n.message.includes("insertRule")&&n.message.includes("CSSStyleSheet"))throw n;return t.loggerProvider.warn("Error while recording: ",n.toString()),!0}})}},e.prototype.getDeviceId=function(){var e,t,n;return(null===(e=this.config)||void 0===e?void 0:e.instanceName)&&(n=L(this.config.instanceName).identityStore.getIdentity().deviceId),n||(null===(t=this.identifiers)||void 0===t?void 0:t.deviceId)},e.prototype.getSessionId=function(){var e;return null===(e=this.identifiers)||void 0===e?void 0:e.sessionId},e.prototype.flush=function(e){return void 0===e&&(e=!1),c(this,void 0,void 0,(function(){return l(this,(function(t){return this.eventsManager?[2,this.eventsManager.flush(e)]:[2]}))}))},e.prototype.shutdown=function(){var e=P();e&&(e.removeEventListener("blur",this.blurListener),e.removeEventListener("focus",this.focusListener)),this.stopRecordingAndSendEvents()},e}(),Ir=function(e){return function(){var t=e.config||W();return{logger:t.loggerProvider,logLevel:t.logLevel}}},kr=function(){var e=new Sr;return{init:k(e.init.bind(e),"init",Ir(e)),setSessionId:k(e.setSessionId.bind(e),"setSessionId",Ir(e)),getSessionId:k(e.getSessionId.bind(e),"getSessionId",Ir(e)),getSessionReplayProperties:k(e.getSessionReplayProperties.bind(e),"getSessionReplayProperties",Ir(e)),flush:k(e.flush.bind(e),"flush",Ir(e)),shutdown:k(e.shutdown.bind(e),"shutdown",Ir(e))}}(),Cr=kr.init,Mr=kr.setSessionId,xr=kr.getSessionId,Er=kr.getSessionReplayProperties,Or=kr.flush,Tr=kr.shutdown,Rr="@amplitude/plugin-session-replay-enrichment-browser",_r=function(){function e(){this.name=Rr,this.type="enrichment"}return e.prototype.setup=function(e,t){return c(this,void 0,void 0,(function(){return l(this,(function(t){return this.config=e,[2]}))}))},e.prototype.execute=function(e){return c(this,void 0,void 0,(function(){var t;return l(this,(function(n){switch(n.label){case 0:return this.config.sessionId&&this.config.sessionId!==xr()?[4,Mr(this.config.sessionId).promise]:[3,2];case 1:n.sent(),n.label=2;case 2:return this.config.sessionId&&this.config.sessionId===e.session_id&&(t=Er(),e.event_properties=a(a({},e.event_properties),t)),[2,Promise.resolve(e)]}}))}))},e}(),Dr=function(){function e(e){this.name="@amplitude/plugin-session-replay-browser",this.type="destination",this.options=a({},e),!1!==this.options.forceSessionTracking&&(this.options.forceSessionTracking=!0)}return e.prototype.setup=function(e,t){var n,r,i,o;return c(this,void 0,void 0,(function(){return l(this,(function(s){switch(s.label){case 0:return t?(e.loggerProvider.log("Installing @amplitude/plugin-session-replay."),this.clientRemove=t.remove.bind(t),this.config=e,this.options.forceSessionTracking&&("boolean"==typeof e.defaultTracking?!1===e.defaultTracking&&(e.defaultTracking={pageViews:!1,formInteractions:!1,fileDownloads:!1,sessions:!0}):e.defaultTracking=a(a({},e.defaultTracking),{sessions:!0})),[4,Cr(e.apiKey,{instanceName:this.config.instanceName,deviceId:this.config.deviceId,optOut:this.config.optOut,sessionId:this.config.sessionId,loggerProvider:this.config.loggerProvider,logLevel:this.config.logLevel,flushMaxRetries:this.config.flushMaxRetries,serverZone:this.config.serverZone,sampleRate:this.options.sampleRate,privacyConfig:{blockSelector:null===(n=this.options.privacyConfig)||void 0===n?void 0:n.blockSelector,maskSelector:null===(r=this.options.privacyConfig)||void 0===r?void 0:r.maskSelector,unmaskSelector:null===(i=this.options.privacyConfig)||void 0===i?void 0:i.unmaskSelector,defaultMaskLevel:null===(o=this.options.privacyConfig)||void 0===o?void 0:o.defaultMaskLevel},debugMode:this.options.debugMode,configEndpointUrl:this.options.configEndpointUrl}).promise]):(e.loggerProvider.error("SessionReplayPlugin requires v1.9.1+ of the Amplitude SDK."),[2]);case 1:return s.sent(),[4,t.add(new _r).promise];case 2:return s.sent(),[2]}}))}))},e.prototype.execute=function(e){return c(this,void 0,void 0,(function(){return l(this,(function(t){return[2,Promise.resolve({event:e,code:200,message:"success"})]}))}))},e.prototype.flush=function(){return c(this,void 0,void 0,(function(){return l(this,(function(e){switch(e.label){case 0:return[4,Or(!1)];case 1:return e.sent(),[2]}}))}))},e.prototype.teardown=function(){return c(this,void 0,void 0,(function(){return l(this,(function(e){switch(e.label){case 0:return[4,this.clientRemove(Rr).promise];case 1:return e.sent(),Tr(),this.config=null,this.clientRemove=null,[2]}}))}))},e.prototype.getSessionReplayProperties=function(){return Er()},e}(),Nr=function(e){return new Dr(e)};return e.plugin=Nr,e.sessionReplayPlugin=Nr,Object.defineProperty(e,"__esModule",{value:!0}),e}({}),s=function(){(()=>{var e=function(){function e(){}return e.prototype.getApplicationContext=function(){return{versionName:this.versionName,language:t(),platform:"Web",os:void 0,deviceModel:void 0}},e}(),t=function(){return typeof navigator<"u"&&(navigator.languages&&navigator.languages[0]||navigator.language)||""},n=function(){function e(){this.queue=[]}return e.prototype.logEvent=function(e){this.receiver?this.receiver(e):this.queue.length<512&&this.queue.push(e)},e.prototype.setEventReceiver=function(e){this.receiver=e,this.queue.length>0&&(this.queue.forEach((function(t){e(t)})),this.queue=[])},e}(),r=function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};function i(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function o(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}var s=function(e,t){var n,r,o=typeof e;if(o!==typeof t)return!1;try{for(var a=i(["string","number","boolean","undefined"]),c=a.next();!c.done;c=a.next())if(c.value===o)return e===t}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}if(null==e&&null==t)return!0;if(null==e||null==t||e.length!==t.length)return!1;var l=Array.isArray(e),u=Array.isArray(t);if(l!==u)return!1;if(!l||!u){var d=Object.keys(e).sort(),p=Object.keys(t).sort();if(!s(d,p))return!1;var h=!0;return Object.keys(e).forEach((function(n){s(e[n],t[n])||(h=!1)})),h}for(var f=0;f<e.length;f++)if(!s(e[f],t[f]))return!1;return!0};Object.entries||(Object.entries=function(e){for(var t=Object.keys(e),n=t.length,r=new Array(n);n--;)r[n]=[t[n],e[t[n]]];return r});var a=function(){function e(){this.identity={userProperties:{}},this.listeners=new Set}return e.prototype.editIdentity=function(){var e=this,t=r({},this.identity.userProperties),n=r(r({},this.identity),{userProperties:t});return{setUserId:function(e){return n.userId=e,this},setDeviceId:function(e){return n.deviceId=e,this},setUserProperties:function(e){return n.userProperties=e,this},setOptOut:function(e){return n.optOut=e,this},updateUserProperties:function(e){var t,r,s,a,c,l,u=n.userProperties||{};try{for(var d=i(Object.entries(e)),p=d.next();!p.done;p=d.next()){var h=o(p.value,2),f=h[0],v=h[1];switch(f){case"$set":try{for(var m=(s=void 0,i(Object.entries(v))),g=m.next();!g.done;g=m.next()){var y=o(g.value,2),b=y[0],w=y[1];u[b]=w}}catch(e){s={error:e}}finally{try{g&&!g.done&&(a=m.return)&&a.call(m)}finally{if(s)throw s.error}}break;case"$unset":try{for(var S=(c=void 0,i(Object.keys(v))),I=S.next();!I.done;I=S.next())delete u[b=I.value]}catch(e){c={error:e}}finally{try{I&&!I.done&&(l=S.return)&&l.call(S)}finally{if(c)throw c.error}}break;case"$clearAll":u={}}}}catch(e){t={error:e}}finally{try{p&&!p.done&&(r=d.return)&&r.call(d)}finally{if(t)throw t.error}}return n.userProperties=u,this},commit:function(){return e.setIdentity(n),this}}},e.prototype.getIdentity=function(){return r({},this.identity)},e.prototype.setIdentity=function(e){var t=r({},this.identity);this.identity=r({},e),s(t,this.identity)||this.listeners.forEach((function(t){t(e)}))},e.prototype.addIdentityListener=function(e){this.listeners.add(e)},e.prototype.removeIdentityListener=function(e){this.listeners.delete(e)},e}(),c=typeof globalThis<"u"?globalThis:typeof window<"u"?window:self,l=function(){function t(){this.identityStore=new a,this.eventBridge=new n,this.applicationContextProvider=new e}return t.getInstance=function(e){return c.analyticsConnectorInstances||(c.analyticsConnectorInstances={}),c.analyticsConnectorInstances[e]||(c.analyticsConnectorInstances[e]=new t),c.analyticsConnectorInstances[e]},t}(),u=["boot"];window.engagement=function(e){var t,n,r,i,o,s,a;let c=window.engagement,d={_q:null!=(t=null==c?void 0:c._q)?t:[],_configuration:{apiKey:null!=(r=null==(n=null==c?void 0:c._configuration)?void 0:n.apiKey)?r:"",serverUrl:null==(i=null==c?void 0:c._configuration)?void 0:i.serverUrl,serverZone:null!=(s=null==(o=null==c?void 0:c._configuration)?void 0:o.serverZone)?s:"US",options:{...null==(a=null==c?void 0:c._configuration)?void 0:a.options}},_sentry:void 0,init(e,t){var n,r,i;d._configuration.apiKey?console.log("Engagement SDK has already been initialized. Ignoring additional init call."):(d._configuration={...d._configuration,...t,apiKey:e,options:{...d._configuration.options,...null==t?void 0:t.options}},null!=(r=null==(n=d._configuration)?void 0:n.options)&&r.logger&&d._configuration.options.logger.enable(null!=(i=d._configuration.options.logLevel)?i:2),function(e){for(let t of e){let e=document.createElement("script");e.src=t,e.id="engagement-sdk-bundle";let n=document.querySelector("[nonce]");n&&e.setAttribute("nonce",n.nonce||n.getAttribute("nonce")),document.getElementsByTagName("head")[0].appendChild(e)}}(["https://cdn.amplitude.com/engagement-browser/prod/index.min.js.gz"]))},plugin(e){let t=d.init;return{name:"@amplitude/engagement-browser",type:"enrichment",async setup(n,r){var i;let o=null!=(i=n.instanceName)?i:"$default_instance",s=l.getInstance(o).identityStore;t(n.apiKey,{options:{logLevel:n.logLevel},...e,serverZone:n.serverZone}),await window.engagement.boot({user:()=>{let e=s.getIdentity();return{user_id:r.getUserId(),device_id:r.getDeviceId(),user_properties:e.userProperties,getSessionId:r.getSessionId}},integrations:[{track:e=>{r.track(e)}}]}),s.addIdentityListener((e=>{window.engagement._setUserProperties(e.userProperties)}))},execute:async e=>(window.engagement.forwardEvent(e),e)}}},p=d;return new Proxy(d,{get:function(e,t){return t in p?p[t]:"then"!==t?"gs"===t?new Proxy({},{get:function(e,n){return function(){let e=Array.from(arguments),r=`${t}.${n}`;e.unshift(r),d._q.push(e)}}}):u.includes(t)?function(){let e=Array.prototype.slice.call(arguments);return new Promise(((n,r)=>{e.unshift(t,n,r),d._q.push(e)}))}:function(){let e=Array.prototype.slice.call(arguments);e.unshift(t),d._q.push(e)}:void 0}})}()})()};!function(e,t){const n=e.amplitudeGTM;if(n&&"function"==typeof n.init){var a=["init","track","identify","setGroup","groupIdentify","revenue","flush","getUserId","setUserId","getSessionId","setSessionId","setDeviceId","getDeviceId","reset","setOptOut","setTransport"],c=["add","append","clearAll","prepend","set","setOnce","remove","preInsert","postInsert","unset"],l=function(e,t,r){if(t=t.shift(),Array.isArray(t)&&0!==t.length){var i=new n.Identify;if(t.forEach((function(e){if(Array.isArray(e)){var t=e.shift();-1!==c.indexOf(t)&&("unset"===t&&i.unset(e[0]),"clearAll"===t&&i.clearAll(),i[t].apply(i,e))}})),!0===r)return i;e.identify(i)}},u=function(e,t){if(!(t.length<3)&&"string"==typeof t[0]&&"string"==typeof t[1]&&Array.isArray(t[2])&&0!==t[2].length){var n=l(e,[t[2]],!0);e.groupIdentify(t[0],t[1],n)}},d=function(e,t){if((t=t.shift()).price&&t.productId){var r=(new n.Revenue).setProductId(t.productId).setQuantity(t.quantity||1).setPrice(t.price).setRevenue(t.revenue||t.price*(t.quantity||1));t.revenueType&&r.setRevenueType(t.revenueType),t.eventProperties&&r.setEventProperties(t.eventProperties),t.currency&&r.setCurrency(t.currency),t.receipt&&r.setReceipt(t.receipt),t.receiptSig&&r.setReceiptSig(t.receiptSig),e.revenue(r)}},p=function(e){return e?.reduce(((e,t)=>(null!==function(e){try{return new RegExp(e)}catch(e){return console.error(`[Amplitude / GTM] - ${e}`),null}}(t)&&e.push(t),e)),[])},h=function(e,t){const n=t[t.length-1];if(n.autocapture.attribution){const e=[...n.autocapture.attribution.excludeReferrersText||[],...p(n.autocapture.attribution.excludeReferrersRegex)||[]];delete n.autocapture.attribution.excludeReferrersText,delete n.autocapture.attribution.excludeReferrersRegex,0!==e.length&&(n.autocapture.attribution.excludeReferrers=e)}if(n.autocapture.elementInteractions){const e=[...n.autocapture.elementInteractions.pageUrlAllowlistString||[],...p(n.autocapture.elementInteractions.pageUrlAllowlistRegex)||[]];delete n.autocapture.elementInteractions.pageUrlAllowlistString,delete n.autocapture.elementInteractions.pageUrlAllowlistRegex,0!==e.length&&(n.autocapture.elementInteractions.pageUrlAllowlist=e);const t=[...n.autocapture.elementInteractions.dataAttributePrefixString||[],...p(n.autocapture.elementInteractions.dataAttributePrefixRegex)||[]];delete n.autocapture.elementInteractions.dataAttributePrefixString,delete n.autocapture.elementInteractions.dataAttributePrefixRegex,0!==t.length&&(n.autocapture.elementInteractions.dataAttributePrefix=t)}const a=n.userAgentEnrichmentOptions,c=n.pageViewLegacy,l=n.sessionReplay,u=n.guidesSurveys;a&&e.add(i.userAgentEnrichmentPlugin(a)),c&&e.add(r.pageViewV1EnrichmentPlugin()),l&&e.add(o.plugin()),u&&(s(),e.add(window.engagement.plugin()));let d=e.init(...t).promise;return d.then((()=>e.add({name:"gtm-library-enrichment",type:"enrichment",setup:async()=>{},execute:async e=>(e.library="amplitude-ts-gtm/3.14.1",e)}))),d};e[t]=e[t]||function(){var e=[].slice.call(arguments,0),t=e.shift(),r=t?n._iq[t]:n;r||(r=n.createInstance(t));var i=e.shift();if(-1!==a.indexOf(i))return"revenue"===i?d(r,e):"identify"===i?l(r,e):"groupIdentify"===i?u(r,e):"init"===i?h(r,e):r[i].apply(this,e)}}}(window,"_amplitude")})(0,0,e)})();